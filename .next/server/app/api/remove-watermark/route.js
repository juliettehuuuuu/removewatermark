/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/remove-watermark/route";
exports.ids = ["app/api/remove-watermark/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fremove-watermark%2Froute&page=%2Fapi%2Fremove-watermark%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fremove-watermark%2Froute.ts&appDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fremove-watermark%2Froute&page=%2Fapi%2Fremove-watermark%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fremove-watermark%2Froute.ts&appDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_tutu_Desktop_Be_a_Developer_my_ai_tool_project_src_app_api_remove_watermark_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/remove-watermark/route.ts */ \"(rsc)/./src/app/api/remove-watermark/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/remove-watermark/route\",\n        pathname: \"/api/remove-watermark\",\n        filename: \"route\",\n        bundlePath: \"app/api/remove-watermark/route\"\n    },\n    resolvedPagePath: \"/Users/tutu/Desktop/Be a Developer/my-ai-tool-project/src/app/api/remove-watermark/route.ts\",\n    nextConfigOutput,\n    userland: _Users_tutu_Desktop_Be_a_Developer_my_ai_tool_project_src_app_api_remove_watermark_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZyZW1vdmUtd2F0ZXJtYXJrJTJGcm91dGUmcGFnZT0lMkZhcGklMkZyZW1vdmUtd2F0ZXJtYXJrJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcmVtb3ZlLXdhdGVybWFyayUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnR1dHUlMkZEZXNrdG9wJTJGQmUlMjBhJTIwRGV2ZWxvcGVyJTJGbXktYWktdG9vbC1wcm9qZWN0JTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRnR1dHUlMkZEZXNrdG9wJTJGQmUlMjBhJTIwRGV2ZWxvcGVyJTJGbXktYWktdG9vbC1wcm9qZWN0JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNxQjtBQUMyQztBQUN4SDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjs7QUFFMUYiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL3R1dHUvRGVza3RvcC9CZSBhIERldmVsb3Blci9teS1haS10b29sLXByb2plY3Qvc3JjL2FwcC9hcGkvcmVtb3ZlLXdhdGVybWFyay9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcmVtb3ZlLXdhdGVybWFyay9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3JlbW92ZS13YXRlcm1hcmtcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3JlbW92ZS13YXRlcm1hcmsvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvdHV0dS9EZXNrdG9wL0JlIGEgRGV2ZWxvcGVyL215LWFpLXRvb2wtcHJvamVjdC9zcmMvYXBwL2FwaS9yZW1vdmUtd2F0ZXJtYXJrL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fremove-watermark%2Froute&page=%2Fapi%2Fremove-watermark%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fremove-watermark%2Froute.ts&appDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/remove-watermark/route.ts":
/*!***********************************************!*\
  !*** ./src/app/api/remove-watermark/route.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_replicate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/replicate */ \"(rsc)/./src/lib/replicate.ts\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var _lib_security_input_validation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/security/input-validation */ \"(rsc)/./src/lib/security/input-validation.ts\");\n/* harmony import */ var _lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/utils/error-handler */ \"(rsc)/./src/lib/utils/error-handler.ts\");\n\n\n\n\n\n// 内存中简单存储用户每日调用次数（生产环境建议用数据库）\nconst userUsageMap = new Map();\nconst DAILY_LIMIT = 10;\n// 从请求中获取客户端IP的辅助函数\nasync function getClientIpFromRequest(req) {\n    try {\n        const forwardedFor = req.headers.get('x-forwarded-for');\n        const realIp = req.headers.get('x-real-ip');\n        const cfConnectingIp = req.headers.get('cf-connecting-ip');\n        const xClientIp = req.headers.get('x-client-ip');\n        if (cfConnectingIp) return cfConnectingIp;\n        if (realIp) return realIp;\n        if (forwardedFor) return forwardedFor.split(',')[0].trim();\n        if (xClientIp) return xClientIp;\n        return 'unknown';\n    } catch  {\n        return 'unknown';\n    }\n}\n// 安全检查中间件\nfunction createSecurityMiddleware() {\n    return {\n        validateHeaders: (req)=>{\n            const headers = req.headers;\n            // 检查Content-Type\n            const contentType = headers.get('content-type');\n            if (contentType && !contentType.includes('multipart/form-data')) {\n                return {\n                    isValid: false,\n                    error: '只支持multipart/form-data格式'\n                };\n            }\n            // 检查User-Agent\n            const userAgent = headers.get('user-agent');\n            if (!userAgent || userAgent.length > 500) {\n                return {\n                    isValid: false,\n                    error: '无效的User-Agent'\n                };\n            }\n            // 检查请求大小\n            const contentLength = headers.get('content-length');\n            if (contentLength && parseInt(contentLength) > 10 * 1024 * 1024) {\n                return {\n                    isValid: false,\n                    error: '请求体过大'\n                };\n            }\n            return {\n                isValid: true\n            };\n        }\n    };\n}\n// 获取Supabase会话的辅助函数\nasync function getSupabaseSession(req) {\n    const res = new Response();\n    const supabase = (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_2__.createServerClient)(\"https://pyppocnuyvkhyvcfrpmn.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB5cHBvY251eXZraHl2Y2ZycG1uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA5NDMzNTksImV4cCI6MjA2NjUxOTM1OX0.CKMZ8r2ZDu17NsWbrlDSQlCJjsf4xtzSjGdf-Ty6Mts\", {\n        cookies: {\n            get (name) {\n                return req.cookies.get(name)?.value;\n            },\n            set (name, value, options) {\n            // 在API路由中，我们不需要设置cookie\n            },\n            remove (name, options) {\n            // 在API路由中，我们不需要删除cookie\n            }\n        }\n    });\n    const { data: { session }, error } = await supabase.auth.getSession();\n    return {\n        session,\n        error\n    };\n}\n// 去水印API路由，POST方法，接收图片并返回处理后图片URL\nasync function POST(req) {\n    try {\n        // 🔐 安全检查：验证请求头\n        const securityMiddleware = createSecurityMiddleware();\n        const headerValidation = securityMiddleware.validateHeaders(req);\n        if (!headerValidation.isValid) {\n            (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.logSecurityEvent)('invalid_headers', {\n                error: headerValidation.error,\n                ip: await getClientIpFromRequest(req),\n                path: '/api/remove-watermark'\n            });\n            return (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.createErrorResponse)(headerValidation.error, 400, req);\n        }\n        // 登录校验 - 使用Supabase\n        const { session, error: authError } = await getSupabaseSession(req);\n        if (authError || !session || !session.user?.email) {\n            (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.logSecurityEvent)('unauthorized_access', {\n                path: '/api/remove-watermark',\n                ip: await getClientIpFromRequest(req),\n                error: authError?.message\n            });\n            return (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.createErrorResponse)('Not authenticated', 401, req);\n        }\n        const userId = session.user.email;\n        // 🔐 安全检查：记录用户活动\n        (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.logSecurityEvent)('api_access', {\n            userId,\n            endpoint: '/api/remove-watermark',\n            ip: await getClientIpFromRequest(req)\n        });\n        // 使用限制检查\n        const today = new Date().toISOString().slice(0, 10);\n        const usage = userUsageMap.get(userId);\n        if (!usage || usage.date !== today) {\n            userUsageMap.set(userId, {\n                date: today,\n                count: 1\n            });\n        } else if (usage.count >= DAILY_LIMIT) {\n            (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.logSecurityEvent)('rate_limit_exceeded', {\n                userId,\n                endpoint: '/api/remove-watermark',\n                currentCount: usage.count,\n                limit: DAILY_LIMIT\n            });\n            return (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.createErrorResponse)('Daily free limit reached', 429, req);\n        } else {\n            usage.count++;\n            userUsageMap.set(userId, usage);\n        }\n        // 解析FormData获取图片\n        const formData = await req.formData();\n        const file = formData.get('image');\n        if (!file) {\n            return (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.createErrorResponse)('No image uploaded', 400, req);\n        }\n        // 🔐 安全检查：文件验证\n        try {\n            // 1. 验证文件名\n            if (!(0,_lib_security_input_validation__WEBPACK_IMPORTED_MODULE_3__.validateFileName)(file.name)) {\n                (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.logSecurityEvent)('suspicious_filename', {\n                    userId,\n                    filename: file.name,\n                    ip: await getClientIpFromRequest(req)\n                });\n                throw new _lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.FileUploadError('文件名包含危险字符', file.name);\n            }\n            // 2. 验证文件类型和大小\n            const fileValidation = (0,_lib_security_input_validation__WEBPACK_IMPORTED_MODULE_3__.validateInput)(file, _lib_security_input_validation__WEBPACK_IMPORTED_MODULE_3__.fileSchema);\n            if (!fileValidation.isValid) {\n                (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.logSecurityEvent)('invalid_file_upload', {\n                    userId,\n                    filename: file.name,\n                    errors: fileValidation.errors,\n                    ip: await getClientIpFromRequest(req)\n                });\n                throw new _lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.FileUploadError(`文件验证失败: ${fileValidation.errors.join(', ')}`, file.name);\n            }\n            // 3. 验证文件内容\n            const buffer = await file.arrayBuffer();\n            if (!(0,_lib_security_input_validation__WEBPACK_IMPORTED_MODULE_3__.validateImageData)(buffer)) {\n                (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.logSecurityEvent)('invalid_image_content', {\n                    userId,\n                    filename: file.name,\n                    size: buffer.byteLength,\n                    ip: await getClientIpFromRequest(req)\n                });\n                throw new _lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.FileUploadError('无效的图片文件内容', file.name);\n            }\n        } catch (error) {\n            if (error instanceof _lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.FileUploadError) {\n                return (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.createErrorResponse)(error.message, 400, req);\n            }\n            throw error;\n        }\n        // 调用AI处理\n        const resultUrl = await (0,_lib_replicate__WEBPACK_IMPORTED_MODULE_1__.callReplicateAPI)('remove', file);\n        // 🔐 安全检查：记录成功处理\n        (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.logSecurityEvent)('image_processed_successfully', {\n            userId,\n            filename: file.name,\n            fileSize: file.size,\n            resultUrl: resultUrl.substring(0, 50) + '...' // 只记录URL前缀\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            resultUrl,\n            remaining: DAILY_LIMIT - userUsageMap.get(userId).count\n        });\n    } catch (error) {\n        // 🔐 安全检查：记录错误\n        (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.logSecurityEvent)('api_error', {\n            endpoint: '/api/remove-watermark',\n            error: error instanceof Error ? error.message : String(error),\n            ip: await getClientIpFromRequest(req)\n        });\n        if (error instanceof _lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.FileUploadError) {\n            return (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.createErrorResponse)(error.message, 400, req);\n        }\n        return (0,_lib_utils_error_handler__WEBPACK_IMPORTED_MODULE_4__.createErrorResponse)(error instanceof Error ? error.message : 'Internal server error', 500, req);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9yZW1vdmUtd2F0ZXJtYXJrL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUF1RDtBQUNMO0FBQ0E7QUFDOEQ7QUFDZDtBQUVsRyw4QkFBOEI7QUFDOUIsTUFBTVUsZUFBZSxJQUFJQztBQUN6QixNQUFNQyxjQUFjO0FBRXBCLG1CQUFtQjtBQUNuQixlQUFlQyx1QkFBdUJDLEdBQVk7SUFDaEQsSUFBSTtRQUNGLE1BQU1DLGVBQWVELElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO1FBQ3JDLE1BQU1DLFNBQVNKLElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO1FBQy9CLE1BQU1FLGlCQUFpQkwsSUFBSUUsT0FBTyxDQUFDQyxHQUFHLENBQUM7UUFDdkMsTUFBTUcsWUFBWU4sSUFBSUUsT0FBTyxDQUFDQyxHQUFHLENBQUM7UUFFbEMsSUFBSUUsZ0JBQWdCLE9BQU9BO1FBQzNCLElBQUlELFFBQVEsT0FBT0E7UUFDbkIsSUFBSUgsY0FBYyxPQUFPQSxhQUFhTSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQ0MsSUFBSTtRQUN4RCxJQUFJRixXQUFXLE9BQU9BO1FBRXRCLE9BQU87SUFDVCxFQUFFLE9BQU07UUFDTixPQUFPO0lBQ1Q7QUFDRjtBQUVBLFVBQVU7QUFDVixTQUFTRztJQUNQLE9BQU87UUFDTEMsaUJBQWlCLENBQUNWO1lBQ2hCLE1BQU1FLFVBQVVGLElBQUlFLE9BQU87WUFFM0IsaUJBQWlCO1lBQ2pCLE1BQU1TLGNBQWNULFFBQVFDLEdBQUcsQ0FBQztZQUNoQyxJQUFJUSxlQUFlLENBQUNBLFlBQVlDLFFBQVEsQ0FBQyx3QkFBd0I7Z0JBQy9ELE9BQU87b0JBQUVDLFNBQVM7b0JBQU9DLE9BQU87Z0JBQTJCO1lBQzdEO1lBRUEsZUFBZTtZQUNmLE1BQU1DLFlBQVliLFFBQVFDLEdBQUcsQ0FBQztZQUM5QixJQUFJLENBQUNZLGFBQWFBLFVBQVVDLE1BQU0sR0FBRyxLQUFLO2dCQUN4QyxPQUFP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a3RvcC9CZSBhIERldmVsb3Blci9teS1haS10b29sLXByb2plY3Qvc3JjL2FwcC9hcGkvcmVtb3ZlLXdhdGVybWFyay9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBjYWxsUmVwbGljYXRlQVBJIH0gZnJvbSAnQC9saWIvcmVwbGljYXRlJ1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3NzcidcbmltcG9ydCB7IHZhbGlkYXRlSW5wdXQsIGZpbGVTY2hlbWEsIHZhbGlkYXRlSW1hZ2VEYXRhLCB2YWxpZGF0ZUZpbGVOYW1lIH0gZnJvbSAnQC9saWIvc2VjdXJpdHkvaW5wdXQtdmFsaWRhdGlvbidcbmltcG9ydCB7IGNyZWF0ZUVycm9yUmVzcG9uc2UsIGxvZ1NlY3VyaXR5RXZlbnQsIEZpbGVVcGxvYWRFcnJvciB9IGZyb20gJ0AvbGliL3V0aWxzL2Vycm9yLWhhbmRsZXInXG5cbi8vIOWGheWtmOS4reeugOWNleWtmOWCqOeUqOaIt+avj+aXpeiwg+eUqOasoeaVsO+8iOeUn+S6p+eOr+Wig+W7uuiurueUqOaVsOaNruW6k++8iVxuY29uc3QgdXNlclVzYWdlTWFwID0gbmV3IE1hcDxzdHJpbmcsIHsgZGF0ZTogc3RyaW5nLCBjb3VudDogbnVtYmVyIH0+KClcbmNvbnN0IERBSUxZX0xJTUlUID0gMTBcblxuLy8g5LuO6K+35rGC5Lit6I635Y+W5a6i5oi356uvSVDnmoTovoXliqnlh73mlbBcbmFzeW5jIGZ1bmN0aW9uIGdldENsaWVudElwRnJvbVJlcXVlc3QocmVxOiBSZXF1ZXN0KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBmb3J3YXJkZWRGb3IgPSByZXEuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpXG4gICAgY29uc3QgcmVhbElwID0gcmVxLmhlYWRlcnMuZ2V0KCd4LXJlYWwtaXAnKVxuICAgIGNvbnN0IGNmQ29ubmVjdGluZ0lwID0gcmVxLmhlYWRlcnMuZ2V0KCdjZi1jb25uZWN0aW5nLWlwJylcbiAgICBjb25zdCB4Q2xpZW50SXAgPSByZXEuaGVhZGVycy5nZXQoJ3gtY2xpZW50LWlwJylcbiAgICBcbiAgICBpZiAoY2ZDb25uZWN0aW5nSXApIHJldHVybiBjZkNvbm5lY3RpbmdJcFxuICAgIGlmIChyZWFsSXApIHJldHVybiByZWFsSXBcbiAgICBpZiAoZm9yd2FyZGVkRm9yKSByZXR1cm4gZm9yd2FyZGVkRm9yLnNwbGl0KCcsJylbMF0udHJpbSgpXG4gICAgaWYgKHhDbGllbnRJcCkgcmV0dXJuIHhDbGllbnRJcFxuICAgIFxuICAgIHJldHVybiAndW5rbm93bidcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuICd1bmtub3duJ1xuICB9XG59XG5cbi8vIOWuieWFqOajgOafpeS4remXtOS7tlxuZnVuY3Rpb24gY3JlYXRlU2VjdXJpdHlNaWRkbGV3YXJlKCkge1xuICByZXR1cm4ge1xuICAgIHZhbGlkYXRlSGVhZGVyczogKHJlcTogUmVxdWVzdCk6IHsgaXNWYWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSA9PiB7XG4gICAgICBjb25zdCBoZWFkZXJzID0gcmVxLmhlYWRlcnNcbiAgICAgIFxuICAgICAgLy8g5qOA5p+lQ29udGVudC1UeXBlXG4gICAgICBjb25zdCBjb250ZW50VHlwZSA9IGhlYWRlcnMuZ2V0KCdjb250ZW50LXR5cGUnKVxuICAgICAgaWYgKGNvbnRlbnRUeXBlICYmICFjb250ZW50VHlwZS5pbmNsdWRlcygnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpKSB7XG4gICAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcjogJ+WPquaUr+aMgW11bHRpcGFydC9mb3JtLWRhdGHmoLzlvI8nIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g5qOA5p+lVXNlci1BZ2VudFxuICAgICAgY29uc3QgdXNlckFnZW50ID0gaGVhZGVycy5nZXQoJ3VzZXItYWdlbnQnKVxuICAgICAgaWYgKCF1c2VyQWdlbnQgfHwgdXNlckFnZW50Lmxlbmd0aCA+IDUwMCkge1xuICAgICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3I6ICfml6DmlYjnmoRVc2VyLUFnZW50JyB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOajgOafpeivt+axguWkp+Wwj1xuICAgICAgY29uc3QgY29udGVudExlbmd0aCA9IGhlYWRlcnMuZ2V0KCdjb250ZW50LWxlbmd0aCcpXG4gICAgICBpZiAoY29udGVudExlbmd0aCAmJiBwYXJzZUludChjb250ZW50TGVuZ3RoKSA+IDEwICogMTAyNCAqIDEwMjQpIHsgLy8gMTBNQlxuICAgICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3I6ICfor7fmsYLkvZPov4flpKcnIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHsgaXNWYWxpZDogdHJ1ZSB9XG4gICAgfVxuICB9XG59XG5cbi8vIOiOt+WPllN1cGFiYXNl5Lya6K+d55qE6L6F5Yqp5Ye95pWwXG5hc3luYyBmdW5jdGlvbiBnZXRTdXBhYmFzZVNlc3Npb24ocmVxOiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCByZXMgPSBuZXcgUmVzcG9uc2UoKVxuICBcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTZXJ2ZXJDbGllbnQoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSEsXG4gICAge1xuICAgICAgY29va2llczoge1xuICAgICAgICBnZXQobmFtZTogc3RyaW5nKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcS5jb29raWVzLmdldChuYW1lKT8udmFsdWVcbiAgICAgICAgfSxcbiAgICAgICAgc2V0KG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgb3B0aW9uczogYW55KSB7XG4gICAgICAgICAgLy8g5ZyoQVBJ6Lev55Sx5Lit77yM5oiR5Lus5LiN6ZyA6KaB6K6+572uY29va2llXG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZShuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IGFueSkge1xuICAgICAgICAgIC8vIOWcqEFQSei3r+eUseS4re+8jOaIkeS7rOS4jemcgOimgeWIoOmZpGNvb2tpZVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9XG4gIClcbiAgXG4gIGNvbnN0IHsgZGF0YTogeyBzZXNzaW9uIH0sIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKVxuICByZXR1cm4geyBzZXNzaW9uLCBlcnJvciB9XG59XG5cbi8vIOWOu+awtOWNsEFQSei3r+eUse+8jFBPU1Tmlrnms5XvvIzmjqXmlLblm77niYflubbov5Tlm57lpITnkIblkI7lm77niYdVUkxcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyDwn5SQIOWuieWFqOajgOafpe+8mumqjOivgeivt+axguWktFxuICAgIGNvbnN0IHNlY3VyaXR5TWlkZGxld2FyZSA9IGNyZWF0ZVNlY3VyaXR5TWlkZGxld2FyZSgpXG4gICAgY29uc3QgaGVhZGVyVmFsaWRhdGlvbiA9IHNlY3VyaXR5TWlkZGxld2FyZS52YWxpZGF0ZUhlYWRlcnMocmVxKVxuICAgIGlmICghaGVhZGVyVmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICBsb2dTZWN1cml0eUV2ZW50KCdpbnZhbGlkX2hlYWRlcnMnLCB7XG4gICAgICAgIGVycm9yOiBoZWFkZXJWYWxpZGF0aW9uLmVycm9yLFxuICAgICAgICBpcDogYXdhaXQgZ2V0Q2xpZW50SXBGcm9tUmVxdWVzdChyZXEpLFxuICAgICAgICBwYXRoOiAnL2FwaS9yZW1vdmUtd2F0ZXJtYXJrJ1xuICAgICAgfSlcbiAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKGhlYWRlclZhbGlkYXRpb24uZXJyb3IhLCA0MDAsIHJlcSlcbiAgICB9XG5cbiAgICAvLyDnmbvlvZXmoKHpqowgLSDkvb/nlKhTdXBhYmFzZVxuICAgIGNvbnN0IHsgc2Vzc2lvbiwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgZ2V0U3VwYWJhc2VTZXNzaW9uKHJlcSlcbiAgICBcbiAgICBpZiAoYXV0aEVycm9yIHx8ICFzZXNzaW9uIHx8ICFzZXNzaW9uLnVzZXI/LmVtYWlsKSB7XG4gICAgICBsb2dTZWN1cml0eUV2ZW50KCd1bmF1dGhvcml6ZWRfYWNjZXNzJywge1xuICAgICAgICBwYXRoOiAnL2FwaS9yZW1vdmUtd2F0ZXJtYXJrJyxcbiAgICAgICAgaXA6IGF3YWl0IGdldENsaWVudElwRnJvbVJlcXVlc3QocmVxKSxcbiAgICAgICAgZXJyb3I6IGF1dGhFcnJvcj8ubWVzc2FnZVxuICAgICAgfSlcbiAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKCdOb3QgYXV0aGVudGljYXRlZCcsIDQwMSwgcmVxKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCB1c2VySWQgPSBzZXNzaW9uLnVzZXIuZW1haWxcbiAgICBcbiAgICAvLyDwn5SQIOWuieWFqOajgOafpe+8muiusOW9leeUqOaIt+a0u+WKqFxuICAgIGxvZ1NlY3VyaXR5RXZlbnQoJ2FwaV9hY2Nlc3MnLCB7XG4gICAgICB1c2VySWQsXG4gICAgICBlbmRwb2ludDogJy9hcGkvcmVtb3ZlLXdhdGVybWFyaycsXG4gICAgICBpcDogYXdhaXQgZ2V0Q2xpZW50SXBGcm9tUmVxdWVzdChyZXEpXG4gICAgfSlcblxuICAgIC8vIOS9v+eUqOmZkOWItuajgOafpVxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDEwKVxuICAgIGNvbnN0IHVzYWdlID0gdXNlclVzYWdlTWFwLmdldCh1c2VySWQpXG4gICAgaWYgKCF1c2FnZSB8fCB1c2FnZS5kYXRlICE9PSB0b2RheSkge1xuICAgICAgdXNlclVzYWdlTWFwLnNldCh1c2VySWQsIHsgZGF0ZTogdG9kYXksIGNvdW50OiAxIH0pXG4gICAgfSBlbHNlIGlmICh1c2FnZS5jb3VudCA+PSBEQUlMWV9MSU1JVCkge1xuICAgICAgbG9nU2VjdXJpdHlFdmVudCgncmF0ZV9saW1pdF9leGNlZWRlZCcsIHtcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBlbmRwb2ludDogJy9hcGkvcmVtb3ZlLXdhdGVybWFyaycsXG4gICAgICAgIGN1cnJlbnRDb3VudDogdXNhZ2UuY291bnQsXG4gICAgICAgIGxpbWl0OiBEQUlMWV9MSU1JVFxuICAgICAgfSlcbiAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKCdEYWlseSBmcmVlIGxpbWl0IHJlYWNoZWQnLCA0MjksIHJlcSlcbiAgICB9IGVsc2Uge1xuICAgICAgdXNhZ2UuY291bnQrK1xuICAgICAgdXNlclVzYWdlTWFwLnNldCh1c2VySWQsIHVzYWdlKVxuICAgIH1cblxuICAgIC8vIOino+aekEZvcm1EYXRh6I635Y+W5Zu+54mHXG4gICAgY29uc3QgZm9ybURhdGEgPSBhd2FpdCByZXEuZm9ybURhdGEoKVxuICAgIGNvbnN0IGZpbGUgPSBmb3JtRGF0YS5nZXQoJ2ltYWdlJykgYXMgRmlsZSB8IG51bGxcbiAgICBcbiAgICBpZiAoIWZpbGUpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKCdObyBpbWFnZSB1cGxvYWRlZCcsIDQwMCwgcmVxKVxuICAgIH1cblxuICAgIC8vIPCflJAg5a6J5YWo5qOA5p+l77ya5paH5Lu26aqM6K+BXG4gICAgdHJ5IHtcbiAgICAgIC8vIDEuIOmqjOivgeaWh+S7tuWQjVxuICAgICAgaWYgKCF2YWxpZGF0ZUZpbGVOYW1lKGZpbGUubmFtZSkpIHtcbiAgICAgICAgbG9nU2VjdXJpdHlFdmVudCgnc3VzcGljaW91c19maWxlbmFtZScsIHtcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgZmlsZW5hbWU6IGZpbGUubmFtZSxcbiAgICAgICAgICBpcDogYXdhaXQgZ2V0Q2xpZW50SXBGcm9tUmVxdWVzdChyZXEpXG4gICAgICAgIH0pXG4gICAgICAgIHRocm93IG5ldyBGaWxlVXBsb2FkRXJyb3IoJ+aWh+S7tuWQjeWMheWQq+WNsemZqeWtl+espicsIGZpbGUubmFtZSlcbiAgICAgIH1cblxuICAgICAgLy8gMi4g6aqM6K+B5paH5Lu257G75Z6L5ZKM5aSn5bCPXG4gICAgICBjb25zdCBmaWxlVmFsaWRhdGlvbiA9IHZhbGlkYXRlSW5wdXQoZmlsZSwgZmlsZVNjaGVtYSlcbiAgICAgIGlmICghZmlsZVZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICBsb2dTZWN1cml0eUV2ZW50KCdpbnZhbGlkX2ZpbGVfdXBsb2FkJywge1xuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICBmaWxlbmFtZTogZmlsZS5uYW1lLFxuICAgICAgICAgIGVycm9yczogZmlsZVZhbGlkYXRpb24uZXJyb3JzLFxuICAgICAgICAgIGlwOiBhd2FpdCBnZXRDbGllbnRJcEZyb21SZXF1ZXN0KHJlcSlcbiAgICAgICAgfSlcbiAgICAgICAgdGhyb3cgbmV3IEZpbGVVcGxvYWRFcnJvcihg5paH5Lu26aqM6K+B5aSx6LSlOiAke2ZpbGVWYWxpZGF0aW9uLmVycm9ycy5qb2luKCcsICcpfWAsIGZpbGUubmFtZSlcbiAgICAgIH1cblxuICAgICAgLy8gMy4g6aqM6K+B5paH5Lu25YaF5a65XG4gICAgICBjb25zdCBidWZmZXIgPSBhd2FpdCBmaWxlLmFycmF5QnVmZmVyKClcbiAgICAgIGlmICghdmFsaWRhdGVJbWFnZURhdGEoYnVmZmVyKSkge1xuICAgICAgICBsb2dTZWN1cml0eUV2ZW50KCdpbnZhbGlkX2ltYWdlX2NvbnRlbnQnLCB7XG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIGZpbGVuYW1lOiBmaWxlLm5hbWUsXG4gICAgICAgICAgc2l6ZTogYnVmZmVyLmJ5dGVMZW5ndGgsXG4gICAgICAgICAgaXA6IGF3YWl0IGdldENsaWVudElwRnJvbVJlcXVlc3QocmVxKVxuICAgICAgICB9KVxuICAgICAgICB0aHJvdyBuZXcgRmlsZVVwbG9hZEVycm9yKCfml6DmlYjnmoTlm77niYfmlofku7blhoXlrrknLCBmaWxlLm5hbWUpXG4gICAgICB9XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRmlsZVVwbG9hZEVycm9yKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKGVycm9yLm1lc3NhZ2UsIDQwMCwgcmVxKVxuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG5cbiAgICAvLyDosIPnlKhBSeWkhOeQhlxuICAgIGNvbnN0IHJlc3VsdFVybCA9IGF3YWl0IGNhbGxSZXBsaWNhdGVBUEkoJ3JlbW92ZScsIGZpbGUpXG4gICAgXG4gICAgLy8g8J+UkCDlronlhajmo4Dmn6XvvJrorrDlvZXmiJDlip/lpITnkIZcbiAgICBsb2dTZWN1cml0eUV2ZW50KCdpbWFnZV9wcm9jZXNzZWRfc3VjY2Vzc2Z1bGx5Jywge1xuICAgICAgdXNlcklkLFxuICAgICAgZmlsZW5hbWU6IGZpbGUubmFtZSxcbiAgICAgIGZpbGVTaXplOiBmaWxlLnNpemUsXG4gICAgICByZXN1bHRVcmw6IHJlc3VsdFVybC5zdWJzdHJpbmcoMCwgNTApICsgJy4uLicgLy8g5Y+q6K6w5b2VVVJM5YmN57yAXG4gICAgfSlcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgcmVzdWx0VXJsLCBcbiAgICAgIHJlbWFpbmluZzogREFJTFlfTElNSVQgLSB1c2VyVXNhZ2VNYXAuZ2V0KHVzZXJJZCkhLmNvdW50IFxuICAgIH0pXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAvLyDwn5SQIOWuieWFqOajgOafpe+8muiusOW9lemUmeivr1xuICAgIGxvZ1NlY3VyaXR5RXZlbnQoJ2FwaV9lcnJvcicsIHtcbiAgICAgIGVuZHBvaW50OiAnL2FwaS9yZW1vdmUtd2F0ZXJtYXJrJyxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvciksXG4gICAgICBpcDogYXdhaXQgZ2V0Q2xpZW50SXBGcm9tUmVxdWVzdChyZXEpXG4gICAgfSlcblxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEZpbGVVcGxvYWRFcnJvcikge1xuICAgICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoZXJyb3IubWVzc2FnZSwgNDAwLCByZXEpXG4gICAgfVxuXG4gICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoXG4gICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxuICAgICAgNTAwLFxuICAgICAgcmVxXG4gICAgKVxuICB9XG59ICJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjYWxsUmVwbGljYXRlQVBJIiwiY3JlYXRlU2VydmVyQ2xpZW50IiwidmFsaWRhdGVJbnB1dCIsImZpbGVTY2hlbWEiLCJ2YWxpZGF0ZUltYWdlRGF0YSIsInZhbGlkYXRlRmlsZU5hbWUiLCJjcmVhdGVFcnJvclJlc3BvbnNlIiwibG9nU2VjdXJpdHlFdmVudCIsIkZpbGVVcGxvYWRFcnJvciIsInVzZXJVc2FnZU1hcCIsIk1hcCIsIkRBSUxZX0xJTUlUIiwiZ2V0Q2xpZW50SXBGcm9tUmVxdWVzdCIsInJlcSIsImZvcndhcmRlZEZvciIsImhlYWRlcnMiLCJnZXQiLCJyZWFsSXAiLCJjZkNvbm5lY3RpbmdJcCIsInhDbGllbnRJcCIsInNwbGl0IiwidHJpbSIsImNyZWF0ZVNlY3VyaXR5TWlkZGxld2FyZSIsInZhbGlkYXRlSGVhZGVycyIsImNvbnRlbnRUeXBlIiwiaW5jbHVkZXMiLCJpc1ZhbGlkIiwiZXJyb3IiLCJ1c2VyQWdlbnQiLCJsZW5ndGgiLCJjb250ZW50TGVuZ3RoIiwicGFyc2VJbnQiLCJnZXRTdXBhYmFzZVNlc3Npb24iLCJyZXMiLCJSZXNwb25zZSIsInN1cGFiYXNlIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiY29va2llcyIsIm5hbWUiLCJ2YWx1ZSIsInNldCIsIm9wdGlvbnMiLCJyZW1vdmUiLCJkYXRhIiwic2Vzc2lvbiIsImF1dGgiLCJnZXRTZXNzaW9uIiwiUE9TVCIsInNlY3VyaXR5TWlkZGxld2FyZSIsImhlYWRlclZhbGlkYXRpb24iLCJpcCIsInBhdGgiLCJhdXRoRXJyb3IiLCJ1c2VyIiwiZW1haWwiLCJtZXNzYWdlIiwidXNlcklkIiwiZW5kcG9pbnQiLCJ0b2RheSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNsaWNlIiwidXNhZ2UiLCJkYXRlIiwiY291bnQiLCJjdXJyZW50Q291bnQiLCJsaW1pdCIsImZvcm1EYXRhIiwiZmlsZSIsImZpbGVuYW1lIiwiZmlsZVZhbGlkYXRpb24iLCJlcnJvcnMiLCJqb2luIiwiYnVmZmVyIiwiYXJyYXlCdWZmZXIiLCJzaXplIiwiYnl0ZUxlbmd0aCIsInJlc3VsdFVybCIsImZpbGVTaXplIiwic3Vic3RyaW5nIiwianNvbiIsInJlbWFpbmluZyIsIkVycm9yIiwiU3RyaW5nIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/remove-watermark/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/replicate.ts":
/*!******************************!*\
  !*** ./src/lib/replicate.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   callReplicateAPI: () => (/* binding */ callReplicateAPI)\n/* harmony export */ });\n// 该文件封装与Replicate API的真实交互逻辑，支持不同功能调用不同模型\n// 通过环境变量安全读取API Token\nconst REPLICATE_API_TOKEN = process.env.REPLICATE_API_TOKEN;\n// Replicate模型配置，按功能区分\nconst models = {\n    remove: {\n        // flux-kontext-apps/text-removal\n        version: \"e28636410bff2b083e38f4e856a5b2be171c8bb6636f527b1a9e84dff29d1c54\",\n        modelInput: (base64)=>({\n                input_image: `data:image/png;base64,${base64}`\n            })\n    },\n    enhance: {\n        // flux-kontext-apps/restore-image\n        version: \"85ae46551612b8f778348846b6ce1ce1b340e384fe2062399c0c412be29e107d\",\n        modelInput: (base64)=>({\n                input_image: `data:image/png;base64,${base64}`\n            })\n    }\n};\n// 生成带水印的模拟处理图片\nasync function generateMockProcessedImage(file, action) {\n    return new Promise((resolve)=>{\n        const canvas = document.createElement?.('canvas');\n        // 如果在服务器环境或无canvas支持，返回带标识的data URL\n        if (!canvas || typeof document === 'undefined') {\n            console.log('🔧 模拟处理模式: 服务器环境，返回标识性结果');\n            const reader = new FileReader();\n            reader.onload = ()=>{\n                const base64 = reader.result.split(',')[1];\n                // 返回带有特殊标识的base64，表明这是模拟处理的结果\n                resolve(`data:${file.type};base64,${base64}`);\n            };\n            // 由于在服务器环境，我们需要手动转换\n            file.arrayBuffer().then((buffer)=>{\n                const base64 = Buffer.from(buffer).toString('base64');\n                const mimeType = file.type || 'image/png';\n                console.log(`🔧 模拟处理完成: ${action} - 返回原图作为示例结果`);\n                resolve(`data:${mimeType};base64,${base64}`);\n            });\n            return;\n        }\n        // 客户端环境的canvas处理（实际上在API路由中不会执行）\n        const ctx = canvas.getContext('2d');\n        const img = new Image();\n        img.onload = ()=>{\n            canvas.width = img.width;\n            canvas.height = img.height;\n            // 绘制原图\n            ctx.drawImage(img, 0, 0);\n            // 添加模拟处理效果\n            ctx.fillStyle = 'rgba(255, 0, 0, 0.1)';\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n            // 添加水印表示这是模拟处理\n            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\n            ctx.font = '20px Arial';\n            ctx.fillText(`MOCK ${action.toUpperCase()} PROCESSED`, 10, 30);\n            resolve(canvas.toDataURL(file.type));\n        };\n        // 这在服务器环境中不会执行\n        const reader = new FileReader();\n        reader.onload = ()=>img.src = reader.result;\n        reader.readAsDataURL(file);\n    });\n}\n// 通用AI图片处理函数\nasync function callReplicateAPI(action, file) {\n    if (!REPLICATE_API_TOKEN) {\n        console.log('⚠️ Replicate API token not set, using mock processing for development');\n        console.log('📝 提示: 要使用真实的AI处理，请在.env.local文件中设置REPLICATE_API_TOKEN');\n        console.log('🔗 获取API Token: https://replicate.com/account/api-tokens');\n        // 开发环境：模拟处理\n        const arrayBuffer = await file.arrayBuffer();\n        const base64 = Buffer.from(arrayBuffer).toString('base64');\n        const mimeType = file.type || 'image/png';\n        // 模拟处理延迟\n        await new Promise((resolve)=>setTimeout(resolve, 1000));\n        console.log(`🔧 模拟处理完成: ${action} - 文件大小: ${file.size} bytes`);\n        console.log('💡 当前返回原图，配置REPLICATE_API_TOKEN后将使用真实AI处理');\n        return `data:${mimeType};base64,${base64}`;\n    }\n    const model = models[action];\n    if (!model) throw new Error('Unknown action');\n    // 读取图片为base64\n    const arrayBuffer = await file.arrayBuffer();\n    const base64 = Buffer.from(arrayBuffer).toString('base64');\n    // 调试日志：打印模型和请求体\n    console.log('[Replicate] 调用模型:', model.version);\n    console.log('[Replicate] 请求input:', model.modelInput(base64));\n    // 1. 创建预测任务\n    const res = await fetch('https://api.replicate.com/v1/predictions', {\n        method: 'POST',\n        headers: {\n            'Authorization': `Token ${REPLICATE_API_TOKEN}`,\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n            version: model.version,\n            input: model.modelInput(base64)\n        })\n    });\n    if (!res.ok) {\n        const err = await res.text();\n        console.error('[Replicate] 创建预测失败:', err);\n        throw new Error('Failed to create prediction: ' + err);\n    }\n    const data = await res.json();\n    let prediction = data;\n    // 2. 轮询获取结果\n    while(prediction.status !== 'succeeded' && prediction.status !== 'failed'){\n        await new Promise((r)=>setTimeout(r, 1500));\n        const pollRes = await fetch(`https://api.replicate.com/v1/predictions/${prediction.id}`, {\n            headers: {\n                'Authorization': `Token ${REPLICATE_API_TOKEN}`\n            }\n        });\n        prediction = await pollRes.json();\n        console.log('[Replicate] 轮询状态:', prediction.status);\n    }\n    if (prediction.status === 'succeeded') {\n        // 返回图片URL（部分模型为数组，部分为字符串）\n        console.log('[Replicate] 处理成功，输出:', prediction.output);\n        if (Array.isArray(prediction.output)) return prediction.output[0];\n        return prediction.output;\n    }\n    console.error('[Replicate] 处理失败:', prediction.error || prediction);\n    throw new Error('Replicate AI failed: ' + (prediction.error || 'Unknown error'));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3JlcGxpY2F0ZS50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsMENBQTBDO0FBQzFDLHNCQUFzQjtBQUV0QixNQUFNQSxzQkFBc0JDLFFBQVFDLEdBQUcsQ0FBQ0YsbUJBQW1CO0FBRTNELHNCQUFzQjtBQUN0QixNQUFNRyxTQUFTO0lBQ2JDLFFBQVE7UUFDTixpQ0FBaUM7UUFDakNDLFNBQVM7UUFDVEMsWUFBWSxDQUFDQyxTQUFvQjtnQkFBRUMsYUFBYSxDQUFDLHNCQUFzQixFQUFFRCxRQUFRO1lBQUM7SUFDcEY7SUFDQUUsU0FBUztRQUNQLGtDQUFrQztRQUNsQ0osU0FBUztRQUNUQyxZQUFZLENBQUNDLFNBQW9CO2dCQUFFQyxhQUFhLENBQUMsc0JBQXNCLEVBQUVELFFBQVE7WUFBQztJQUNwRjtBQUVGO0FBRUEsZUFBZTtBQUNmLGVBQWVHLDJCQUEyQkMsSUFBVSxFQUFFQyxNQUFjO0lBQ2xFLE9BQU8sSUFBSUMsUUFBUSxDQUFDQztRQUNsQixNQUFNQyxTQUFTQyxTQUFTQyxhQUFhLEdBQUc7UUFFeEMsb0NBQW9DO1FBQ3BDLElBQUksQ0FBQ0YsVUFBVSxPQUFPQyxhQUFhLGFBQWE7WUFDOUNFLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU1DLFNBQVMsSUFBSUM7WUFDbkJELE9BQU9FLE1BQU0sR0FBRztnQkFDZCxNQUFNZixTQUFTLE9BQVFnQixNQUFNLENBQVlDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDdEQsOEJBQThCO2dCQUM5QlYsUUFBUSxDQUFDLEtBQUssRUFBRUgsS0FBS2MsSUFBSSxDQUFDLFFBQVEsRUFBRWxCLFFBQVE7WUFDOUM7WUFDQSxvQkFBb0I7WUFDcEJJLEtBQUtlLFdBQVcsR0FBR0MsSUFBSSxDQUFDQyxDQUFBQTtnQkFDdEIsTUFBTXJCLFNBQVNzQixPQUFPQyxJQUFJLENBQUNGLFFBQVFHLFFBQVEsQ0FBQztnQkFDNUMsTUFBTUMsV0FBV3JCLEtBQUtjLElBQUksSUFBSTtnQkFDOUJQLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFdBQVcsRUFBRVAsT0FBTyxhQUFhLENBQUM7Z0JBQy9DRSxRQUFRLENBQUMsS0FBSyxFQUFFa0IsU0FBUyxRQUFRLEVBQUV6QixRQUFRO1lBQzdDO1lBQ0E7UUFDRjtRQUVBLGlDQUFpQztRQUNqQyxNQUFNMEIsTUFBTWxCLE9BQU9tQixVQUFVLENBQUM7UUFDOUIsTUFBTUMsTUFBTSxJQUFJQztRQUVoQkQsSUFBSWIsTUFBTSxHQUFHO1lBQ1hQLE9BQU9zQixLQUFLLEdBQUdGLElBQUlFLEtBQUs7WUFDeEJ0QixPQUFPdUIsTUFBTSxHQUFHSCxJQUFJRyxNQUFNO1lBRTFCLE9BQU87WUFDUEwsSUFBS00sU0FBUyxDQUFDSixLQUFLLEdBQUc7WUFFdkIsV0FBVztZQUNYRixJQUFLTyxTQUFTLEdBQUc7WUFDakJQLElBQUtRLFFBQVEsQ0FBQyxHQUFHLEdBQUcxQixPQUFPc0IsS0FBSyxFQUFFdEIsT0FBT3VCLE1BQU07WUFFL0MsZUFBZTtZQUNmTCxJQUFLTyxTQUFTLEdBQUc7WUFDakJQLElBQUtTLElBQUksR0FBRztZQUNaVCxJQUFLVSxRQUFRLENBQUMsQ0FBQyxLQUFLLEVBQUUvQixPQUFPZ0MsV0FBVyxHQUFHLFVBQVUsQ0FBQyxFQUFFLElBQUk7WUFFNUQ5QixRQUFRQyxPQUFPOEIsU0FBUyxDQUFDbEMsS0FBS2MsSUFBSTtRQUNwQztRQUVBLGVBQWU7UUFDZixNQUFNTCxTQUFTLElBQUlDO1FBQ25CRCxPQUFPRSxNQUFNLEdBQUcsSUFBTWEsSUFBSVcsR0FBRyxHQUFHMUIsT0FBT0csTUFBTTtRQUM3Q0gsT0FBTzJCLGFBQWEsQ0FBQ3BDO0lBQ3ZCO0FBQ0Y7QUFFQSxhQUFhO0FBQ04sZUFBZXFDLGlCQUFpQnBDLE1BQTRCLEVBQUVELElBQVU7SUFDN0UsSUFBSSxDQUFDWCxxQkFBcUI7UUFDeEJrQixRQUFRQyxHQUFHLENBQUM7UUFDWkQsUUFBUUMsR0FBRyxDQUFDO1FBQ1pELFFBQVFDLEdBQUcsQ0FBQztRQUVaLFlBQVk7UUFDWixNQUFNTyxjQUFjLE1BQU1mLEtBQUtlLFdBQVc7UUFDMUMsTUFBTW5CLFNBQVNzQixPQUFPQyxJQUFJLENBQUNKLGFBQWFLLFFBQVEsQ0FBQztRQUNqRCxNQUFNQyxXQUFXckIsS0FBS2MsSUFBSSxJQUFJO1FBRTlCLFNBQVM7UUFDVCxNQUFNLElBQUlaLFFBQVFDLENBQUFBLFVBQVdtQyxXQUFXbkMsU0FBUztRQUVqREksUUFBUUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFUCxPQUFPLFNBQVMsRUFBRUQsS0FBS3VDLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDN0RoQyxRQUFRQyxHQUFHLENBQUM7UUFFWixPQUFPLENBQUMsS0FBSyxFQUFFYSxTQUFTLFFBQVEsRUFBRXpCLFFBQVE7SUFDNUM7SUFFQSxNQUFNNEMsUUFBUWhELE1BQU0sQ0FBQ1MsT0FBTztJQUM1QixJQUFJLENBQUN1QyxPQUFPLE1BQU0sSUFBSUMsTUFBTTtJQUU1QixjQUFjO0lBQ2QsTUFBTTFCLGNBQWMsTUFBTWYsS0FBS2UsV0FBVztJQUMxQyxNQUFNbkIsU0FBU3NCLE9BQU9DLElBQUksQ0FBQ0osYUFBYUssUUFBUSxDQUFDO0lBRWpELGdCQUFnQjtJQUNoQmIsUUFBUUMsR0FBRyxDQUFDLHFCQUFxQmdDLE1BQU05QyxPQUFPO0lBQzlDYSxRQUFRQyxHQUFHLENBQUMsd0JBQXdCZ0MsTUFBTTdDLFVBQVUsQ0FBQ0M7SUFFckQsWUFBWTtJQUNaLE1BQU04QyxNQUFNLE1BQU1DLE1BQU0sNENBQTRDO1FBQ2xFQyxRQUFRO1FBQ1JDLFNBQVM7WUFDUCxpQkFBaUIsQ0FBQyxNQUFNLEVBQUV4RCxxQkFBcUI7WUFDL0MsZ0JBQWdCO1FBQ2xCO1FBQ0F5RCxNQUFNQyxLQUFLQyxTQUFTLENBQUM7WUFDbkJ0RCxTQUFTOEMsTUFBTTlDLE9BQU87WUFDdEJ1RCxPQUFPVCxNQUFNN0MsVUFBVSxDQUFDQztRQUMxQjtJQUNGO0lBQ0EsSUFBSSxDQUFDOEMsSUFBSVEsRUFBRSxFQUFFO1FBQ1gsTUFBTUMsTUFBTSxNQUFNVCxJQUFJVSxJQUFJO1FBQzFCN0MsUUFBUThDLEtBQUssQ0FBQyx1QkFBdUJGO1FBQ3JDLE1BQU0sSUFBSVYsTUFBTSxrQ0FBa0NVO0lBQ3BEO0lBQ0EsTUFBTUcsT0FBTyxNQUFNWixJQUFJYSxJQUFJO0lBQzNCLElBQUlDLGFBQWFGO0lBRWpCLFlBQVk7SUFDWixNQUFPRSxXQUFXQyxNQUFNLEtBQUssZUFBZUQsV0FBV0MsTUFBTSxLQUFLLFNBQVU7UUFDMUUsTUFBTSxJQUFJdkQsUUFBUXdELENBQUFBLElBQUtwQixXQUFXb0IsR0FBRztRQUNyQyxNQUFNQyxVQUFVLE1BQU1oQixNQUFNLENBQUMseUNBQXlDLEVBQUVhLFdBQVdJLEVBQUUsRUFBRSxFQUFFO1lBQ3ZGZixTQUFTO2dCQUFFLGlCQUFpQixDQUFDLE1BQU0sRUFBRXhELHFCQUFxQjtZQUFDO1FBQzdEO1FBQ0FtRSxhQUFhLE1BQU1HLFFBQVFKLElBQUk7UUFDL0JoRCxRQUFRQyxHQUFHLENBQUMscUJBQXFCZ0QsV0FBV0MsTUFBTTtJQUNwRDtJQUNBLElBQUlELFdBQVdDLE1BQU0sS0FBSyxhQUFhO1FBQ3JDLDBCQUEwQjtRQUMxQmxELFFBQVFDLEdBQUcsQ0FBQyx3QkFBd0JnRCxXQUFXSyxNQUFNO1FBQ3JELElBQUlDLE1BQU1DLE9BQU8sQ0FBQ1AsV0FBV0ssTUFBTSxHQUFHLE9BQU9MLFdBQVdLLE1BQU0sQ0FBQyxFQUFFO1FBQ2pFLE9BQU9MLFdBQVdLLE1BQU07SUFDMUI7SUFDQXRELFFBQVE4QyxLQUFLLENBQUMscUJBQXFCRyxXQUFXSCxLQUFLLElBQUlHO0lBQ3ZELE1BQU0sSUFBSWYsTUFBTSwwQkFBMkJlLENBQUFBLFdBQVdILEtBQUssSUFBSSxlQUFjO0FBQy9FIiwic291cmNlcyI6WyIvVXNlcnMvdHV0dS9EZXNrdG9wL0JlIGEgRGV2ZWxvcGVyL215LWFpLXRvb2wtcHJvamVjdC9zcmMvbGliL3JlcGxpY2F0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyDor6Xmlofku7blsIHoo4XkuI5SZXBsaWNhdGUgQVBJ55qE55yf5a6e5Lqk5LqS6YC76L6R77yM5pSv5oyB5LiN5ZCM5Yqf6IO96LCD55So5LiN5ZCM5qih5Z6LXG4vLyDpgJrov4fnjq/looPlj5jph4/lronlhajor7vlj5ZBUEkgVG9rZW5cblxuY29uc3QgUkVQTElDQVRFX0FQSV9UT0tFTiA9IHByb2Nlc3MuZW52LlJFUExJQ0FURV9BUElfVE9LRU5cblxuLy8gUmVwbGljYXRl5qih5Z6L6YWN572u77yM5oyJ5Yqf6IO95Yy65YiGXG5jb25zdCBtb2RlbHMgPSB7XG4gIHJlbW92ZToge1xuICAgIC8vIGZsdXgta29udGV4dC1hcHBzL3RleHQtcmVtb3ZhbFxuICAgIHZlcnNpb246IFwiZTI4NjM2NDEwYmZmMmIwODNlMzhmNGU4NTZhNWIyYmUxNzFjOGJiNjYzNmY1MjdiMWE5ZTg0ZGZmMjlkMWM1NFwiLFxuICAgIG1vZGVsSW5wdXQ6IChiYXNlNjQ6IHN0cmluZykgPT4gKHsgaW5wdXRfaW1hZ2U6IGBkYXRhOmltYWdlL3BuZztiYXNlNjQsJHtiYXNlNjR9YCB9KVxuICB9LFxuICBlbmhhbmNlOiB7XG4gICAgLy8gZmx1eC1rb250ZXh0LWFwcHMvcmVzdG9yZS1pbWFnZVxuICAgIHZlcnNpb246IFwiODVhZTQ2NTUxNjEyYjhmNzc4MzQ4ODQ2YjZjZTFjZTFiMzQwZTM4NGZlMjA2MjM5OWMwYzQxMmJlMjllMTA3ZFwiLFxuICAgIG1vZGVsSW5wdXQ6IChiYXNlNjQ6IHN0cmluZykgPT4gKHsgaW5wdXRfaW1hZ2U6IGBkYXRhOmltYWdlL3BuZztiYXNlNjQsJHtiYXNlNjR9YCB9KVxuICB9LFxuICAvLyB0dW5lOiAuLi7vvIjlpoLmnInlvq7osIPmqKHlnovlj6/ooaXlhYXvvIlcbn1cblxuLy8g55Sf5oiQ5bim5rC05Y2w55qE5qih5ouf5aSE55CG5Zu+54mHXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZU1vY2tQcm9jZXNzZWRJbWFnZShmaWxlOiBGaWxlLCBhY3Rpb246IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQ/LignY2FudmFzJykgXG4gICAgXG4gICAgLy8g5aaC5p6c5Zyo5pyN5Yqh5Zmo546v5aKD5oiW5pegY2FudmFz5pSv5oyB77yM6L+U5Zue5bim5qCH6K+G55qEZGF0YSBVUkxcbiAgICBpZiAoIWNhbnZhcyB8fCB0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+UpyDmqKHmi5/lpITnkIbmqKHlvI86IOacjeWKoeWZqOeOr+Wig++8jOi/lOWbnuagh+ivhuaAp+e7k+aenCcpXG4gICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgICByZWFkZXIub25sb2FkID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBiYXNlNjQgPSAocmVhZGVyLnJlc3VsdCBhcyBzdHJpbmcpLnNwbGl0KCcsJylbMV1cbiAgICAgICAgLy8g6L+U5Zue5bim5pyJ54m55q6K5qCH6K+G55qEYmFzZTY077yM6KGo5piO6L+Z5piv5qih5ouf5aSE55CG55qE57uT5p6cXG4gICAgICAgIHJlc29sdmUoYGRhdGE6JHtmaWxlLnR5cGV9O2Jhc2U2NCwke2Jhc2U2NH1gKVxuICAgICAgfVxuICAgICAgLy8g55Sx5LqO5Zyo5pyN5Yqh5Zmo546v5aKD77yM5oiR5Lus6ZyA6KaB5omL5Yqo6L2s5o2iXG4gICAgICBmaWxlLmFycmF5QnVmZmVyKCkudGhlbihidWZmZXIgPT4ge1xuICAgICAgICBjb25zdCBiYXNlNjQgPSBCdWZmZXIuZnJvbShidWZmZXIpLnRvU3RyaW5nKCdiYXNlNjQnKVxuICAgICAgICBjb25zdCBtaW1lVHlwZSA9IGZpbGUudHlwZSB8fCAnaW1hZ2UvcG5nJ1xuICAgICAgICBjb25zb2xlLmxvZyhg8J+UpyDmqKHmi5/lpITnkIblrozmiJA6ICR7YWN0aW9ufSAtIOi/lOWbnuWOn+WbvuS9nOS4uuekuuS+i+e7k+aenGApXG4gICAgICAgIHJlc29sdmUoYGRhdGE6JHttaW1lVHlwZX07YmFzZTY0LCR7YmFzZTY0fWApXG4gICAgICB9KVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8g5a6i5oi356uv546v5aKD55qEY2FudmFz5aSE55CG77yI5a6e6ZmF5LiK5ZyoQVBJ6Lev55Sx5Lit5LiN5Lya5omn6KGM77yJXG4gICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJylcbiAgICBjb25zdCBpbWcgPSBuZXcgSW1hZ2UoKVxuICAgIFxuICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICBjYW52YXMud2lkdGggPSBpbWcud2lkdGhcbiAgICAgIGNhbnZhcy5oZWlnaHQgPSBpbWcuaGVpZ2h0XG4gICAgICBcbiAgICAgIC8vIOe7mOWItuWOn+WbvlxuICAgICAgY3R4IS5kcmF3SW1hZ2UoaW1nLCAwLCAwKVxuICAgICAgXG4gICAgICAvLyDmt7vliqDmqKHmi5/lpITnkIbmlYjmnpxcbiAgICAgIGN0eCEuZmlsbFN0eWxlID0gJ3JnYmEoMjU1LCAwLCAwLCAwLjEpJ1xuICAgICAgY3R4IS5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpXG4gICAgICBcbiAgICAgIC8vIOa3u+WKoOawtOWNsOihqOekuui/meaYr+aooeaLn+WkhOeQhlxuICAgICAgY3R4IS5maWxsU3R5bGUgPSAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpJ1xuICAgICAgY3R4IS5mb250ID0gJzIwcHggQXJpYWwnXG4gICAgICBjdHghLmZpbGxUZXh0KGBNT0NLICR7YWN0aW9uLnRvVXBwZXJDYXNlKCl9IFBST0NFU1NFRGAsIDEwLCAzMClcbiAgICAgIFxuICAgICAgcmVzb2x2ZShjYW52YXMudG9EYXRhVVJMKGZpbGUudHlwZSkpXG4gICAgfVxuICAgIFxuICAgIC8vIOi/meWcqOacjeWKoeWZqOeOr+Wig+S4reS4jeS8muaJp+ihjFxuICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICByZWFkZXIub25sb2FkID0gKCkgPT4gaW1nLnNyYyA9IHJlYWRlci5yZXN1bHQgYXMgc3RyaW5nXG4gICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSlcbiAgfSlcbn1cblxuLy8g6YCa55SoQUnlm77niYflpITnkIblh73mlbBcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYWxsUmVwbGljYXRlQVBJKGFjdGlvbjogJ3JlbW92ZScgfCAnZW5oYW5jZScsIGZpbGU6IEZpbGUpOiBQcm9taXNlPHN0cmluZz4ge1xuICBpZiAoIVJFUExJQ0FURV9BUElfVE9LRU4pIHtcbiAgICBjb25zb2xlLmxvZygn4pqg77iPIFJlcGxpY2F0ZSBBUEkgdG9rZW4gbm90IHNldCwgdXNpbmcgbW9jayBwcm9jZXNzaW5nIGZvciBkZXZlbG9wbWVudCcpXG4gICAgY29uc29sZS5sb2coJ/Cfk50g5o+Q56S6OiDopoHkvb/nlKjnnJ/lrp7nmoRBSeWkhOeQhu+8jOivt+WcqC5lbnYubG9jYWzmlofku7bkuK3orr7nva5SRVBMSUNBVEVfQVBJX1RPS0VOJylcbiAgICBjb25zb2xlLmxvZygn8J+UlyDojrflj5ZBUEkgVG9rZW46IGh0dHBzOi8vcmVwbGljYXRlLmNvbS9hY2NvdW50L2FwaS10b2tlbnMnKVxuICAgIFxuICAgIC8vIOW8gOWPkeeOr+Wig++8muaooeaLn+WkhOeQhlxuICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpXG4gICAgY29uc3QgYmFzZTY0ID0gQnVmZmVyLmZyb20oYXJyYXlCdWZmZXIpLnRvU3RyaW5nKCdiYXNlNjQnKVxuICAgIGNvbnN0IG1pbWVUeXBlID0gZmlsZS50eXBlIHx8ICdpbWFnZS9wbmcnXG4gICAgXG4gICAgLy8g5qih5ouf5aSE55CG5bu26L+fXG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMDApKVxuICAgIFxuICAgIGNvbnNvbGUubG9nKGDwn5SnIOaooeaLn+WkhOeQhuWujOaIkDogJHthY3Rpb259IC0g5paH5Lu25aSn5bCPOiAke2ZpbGUuc2l6ZX0gYnl0ZXNgKVxuICAgIGNvbnNvbGUubG9nKCfwn5KhIOW9k+WJjei/lOWbnuWOn+Wbvu+8jOmFjee9rlJFUExJQ0FURV9BUElfVE9LRU7lkI7lsIbkvb/nlKjnnJ/lrp5BSeWkhOeQhicpXG4gICAgXG4gICAgcmV0dXJuIGBkYXRhOiR7bWltZVR5cGV9O2Jhc2U2NCwke2Jhc2U2NH1gXG4gIH1cbiAgXG4gIGNvbnN0IG1vZGVsID0gbW9kZWxzW2FjdGlvbl1cbiAgaWYgKCFtb2RlbCkgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIGFjdGlvbicpXG5cbiAgLy8g6K+75Y+W5Zu+54mH5Li6YmFzZTY0XG4gIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpXG4gIGNvbnN0IGJhc2U2NCA9IEJ1ZmZlci5mcm9tKGFycmF5QnVmZmVyKS50b1N0cmluZygnYmFzZTY0JylcblxuICAvLyDosIPor5Xml6Xlv5fvvJrmiZPljbDmqKHlnovlkozor7fmsYLkvZNcbiAgY29uc29sZS5sb2coJ1tSZXBsaWNhdGVdIOiwg+eUqOaooeWeizonLCBtb2RlbC52ZXJzaW9uKVxuICBjb25zb2xlLmxvZygnW1JlcGxpY2F0ZV0g6K+35rGCaW5wdXQ6JywgbW9kZWwubW9kZWxJbnB1dChiYXNlNjQpKVxuXG4gIC8vIDEuIOWIm+W7uumihOa1i+S7u+WKoVxuICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkucmVwbGljYXRlLmNvbS92MS9wcmVkaWN0aW9ucycsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQXV0aG9yaXphdGlvbic6IGBUb2tlbiAke1JFUExJQ0FURV9BUElfVE9LRU59YCxcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9LFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIHZlcnNpb246IG1vZGVsLnZlcnNpb24sXG4gICAgICBpbnB1dDogbW9kZWwubW9kZWxJbnB1dChiYXNlNjQpXG4gICAgfSlcbiAgfSlcbiAgaWYgKCFyZXMub2spIHtcbiAgICBjb25zdCBlcnIgPSBhd2FpdCByZXMudGV4dCgpXG4gICAgY29uc29sZS5lcnJvcignW1JlcGxpY2F0ZV0g5Yib5bu66aKE5rWL5aSx6LSlOicsIGVycilcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgcHJlZGljdGlvbjogJyArIGVycilcbiAgfVxuICBjb25zdCBkYXRhID0gYXdhaXQgcmVzLmpzb24oKVxuICBsZXQgcHJlZGljdGlvbiA9IGRhdGFcblxuICAvLyAyLiDova7or6Lojrflj5bnu5PmnpxcbiAgd2hpbGUgKHByZWRpY3Rpb24uc3RhdHVzICE9PSAnc3VjY2VlZGVkJyAmJiBwcmVkaWN0aW9uLnN0YXR1cyAhPT0gJ2ZhaWxlZCcpIHtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMTUwMCkpXG4gICAgY29uc3QgcG9sbFJlcyA9IGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5yZXBsaWNhdGUuY29tL3YxL3ByZWRpY3Rpb25zLyR7cHJlZGljdGlvbi5pZH1gLCB7XG4gICAgICBoZWFkZXJzOiB7ICdBdXRob3JpemF0aW9uJzogYFRva2VuICR7UkVQTElDQVRFX0FQSV9UT0tFTn1gIH1cbiAgICB9KVxuICAgIHByZWRpY3Rpb24gPSBhd2FpdCBwb2xsUmVzLmpzb24oKVxuICAgIGNvbnNvbGUubG9nKCdbUmVwbGljYXRlXSDova7or6LnirbmgIE6JywgcHJlZGljdGlvbi5zdGF0dXMpXG4gIH1cbiAgaWYgKHByZWRpY3Rpb24uc3RhdHVzID09PSAnc3VjY2VlZGVkJykge1xuICAgIC8vIOi/lOWbnuWbvueJh1VSTO+8iOmDqOWIhuaooeWei+S4uuaVsOe7hO+8jOmDqOWIhuS4uuWtl+espuS4su+8iVxuICAgIGNvbnNvbGUubG9nKCdbUmVwbGljYXRlXSDlpITnkIbmiJDlip/vvIzovpPlh7o6JywgcHJlZGljdGlvbi5vdXRwdXQpXG4gICAgaWYgKEFycmF5LmlzQXJyYXkocHJlZGljdGlvbi5vdXRwdXQpKSByZXR1cm4gcHJlZGljdGlvbi5vdXRwdXRbMF1cbiAgICByZXR1cm4gcHJlZGljdGlvbi5vdXRwdXRcbiAgfVxuICBjb25zb2xlLmVycm9yKCdbUmVwbGljYXRlXSDlpITnkIblpLHotKU6JywgcHJlZGljdGlvbi5lcnJvciB8fCBwcmVkaWN0aW9uKVxuICB0aHJvdyBuZXcgRXJyb3IoJ1JlcGxpY2F0ZSBBSSBmYWlsZWQ6ICcgKyAocHJlZGljdGlvbi5lcnJvciB8fCAnVW5rbm93biBlcnJvcicpKVxufSAiXSwibmFtZXMiOlsiUkVQTElDQVRFX0FQSV9UT0tFTiIsInByb2Nlc3MiLCJlbnYiLCJtb2RlbHMiLCJyZW1vdmUiLCJ2ZXJzaW9uIiwibW9kZWxJbnB1dCIsImJhc2U2NCIsImlucHV0X2ltYWdlIiwiZW5oYW5jZSIsImdlbmVyYXRlTW9ja1Byb2Nlc3NlZEltYWdlIiwiZmlsZSIsImFjdGlvbiIsIlByb21pc2UiLCJyZXNvbHZlIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY29uc29sZSIsImxvZyIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJyZXN1bHQiLCJzcGxpdCIsInR5cGUiLCJhcnJheUJ1ZmZlciIsInRoZW4iLCJidWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJtaW1lVHlwZSIsImN0eCIsImdldENvbnRleHQiLCJpbWciLCJJbWFnZSIsIndpZHRoIiwiaGVpZ2h0IiwiZHJhd0ltYWdlIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJmb250IiwiZmlsbFRleHQiLCJ0b1VwcGVyQ2FzZSIsInRvRGF0YVVSTCIsInNyYyIsInJlYWRBc0RhdGFVUkwiLCJjYWxsUmVwbGljYXRlQVBJIiwic2V0VGltZW91dCIsInNpemUiLCJtb2RlbCIsIkVycm9yIiwicmVzIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJpbnB1dCIsIm9rIiwiZXJyIiwidGV4dCIsImVycm9yIiwiZGF0YSIsImpzb24iLCJwcmVkaWN0aW9uIiwic3RhdHVzIiwiciIsInBvbGxSZXMiLCJpZCIsIm91dHB1dCIsIkFycmF5IiwiaXNBcnJheSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/replicate.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/security/input-validation.ts":
/*!**********************************************!*\
  !*** ./src/lib/security/input-validation.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RateLimiter: () => (/* binding */ RateLimiter),\n/* harmony export */   containsSuspiciousContent: () => (/* binding */ containsSuspiciousContent),\n/* harmony export */   createSecurityMiddleware: () => (/* binding */ createSecurityMiddleware),\n/* harmony export */   emailSchema: () => (/* binding */ emailSchema),\n/* harmony export */   feedbackSchema: () => (/* binding */ feedbackSchema),\n/* harmony export */   fileSchema: () => (/* binding */ fileSchema),\n/* harmony export */   imageProcessingSchema: () => (/* binding */ imageProcessingSchema),\n/* harmony export */   nameSchema: () => (/* binding */ nameSchema),\n/* harmony export */   passwordSchema: () => (/* binding */ passwordSchema),\n/* harmony export */   paymentSchema: () => (/* binding */ paymentSchema),\n/* harmony export */   sanitizeInput: () => (/* binding */ sanitizeInput),\n/* harmony export */   validateFileName: () => (/* binding */ validateFileName),\n/* harmony export */   validateImageData: () => (/* binding */ validateImageData),\n/* harmony export */   validateInput: () => (/* binding */ validateInput),\n/* harmony export */   validateUrl: () => (/* binding */ validateUrl)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/dist/esm/index.js\");\n\n// 🔐 输入验证和安全检查模块\n// 基础验证模式\nconst emailSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.string().email('无效的邮箱格式').max(254, '邮箱地址过长');\nconst passwordSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(8, '密码至少8位').max(128, '密码过长');\nconst nameSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1, '姓名不能为空').max(100, '姓名过长');\n// 文件上传验证\nconst fileSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    size: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().max(5 * 1024 * 1024, '文件大小不能超过5MB'),\n    type: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().refine((type)=>[\n            'image/jpeg',\n            'image/png',\n            'image/webp',\n            'image/gif'\n        ].includes(type), '只支持 JPG, PNG, WEBP, GIF 格式'),\n    name: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().max(255, '文件名过长')\n});\n// 图片处理请求验证\nconst imageProcessingSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    action: zod__WEBPACK_IMPORTED_MODULE_0__.z[\"enum\"]([\n        'remove',\n        'enhance'\n    ], {\n        errorMap: ()=>({\n                message: '无效的操作类型'\n            })\n    }),\n    file: fileSchema\n});\n// 用户反馈验证\nconst feedbackSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    feedback: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1, '反馈内容不能为空').max(1000, '反馈内容不能超过1000字符').refine((text)=>!containsSuspiciousContent(text), '反馈内容包含不当内容')\n});\n// 支付验证\nconst paymentSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    amount: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().positive('金额必须为正数').max(10000, '金额过大'),\n    currency: zod__WEBPACK_IMPORTED_MODULE_0__.z[\"enum\"]([\n        'USD',\n        'EUR',\n        'CNY'\n    ], {\n        errorMap: ()=>({\n                message: '不支持的货币类型'\n            })\n    }),\n    productId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1, '产品ID不能为空').max(100, '产品ID过长'),\n    userId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().uuid('无效的用户ID')\n});\n// 🔍 可疑内容检测\nfunction containsSuspiciousContent(text) {\n    const suspiciousPatterns = [\n        // SQL注入模式\n        /(\\b(union|select|insert|update|delete|drop|create|alter)\\b)/i,\n        /(\\b(script|javascript|vbscript|expression)\\b)/i,\n        /(\\b(onload|onerror|onclick|onmouseover)\\b)/i,\n        // XSS模式\n        /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi,\n        /javascript:/gi,\n        /vbscript:/gi,\n        /on\\w+\\s*=/gi,\n        // 命令注入模式\n        /(\\b(cmd|command|exec|system|shell)\\b)/i,\n        /[;&|`$(){}[\\]]/g,\n        // 路径遍历\n        /\\.\\.\\//g,\n        /\\.\\.\\\\/g,\n        // 特殊字符过多\n        /[<>\\\"'&]{3,}/g\n    ];\n    return suspiciousPatterns.some((pattern)=>pattern.test(text));\n}\n// 🔍 输入清理\nfunction sanitizeInput(input) {\n    return input.trim().replace(/[<>\\\"'&]/g, (match)=>{\n        const entities = {\n            '<': '&lt;',\n            '>': '&gt;',\n            '\"': '&quot;',\n            \"'\": '&#x27;',\n            '&': '&amp;'\n        };\n        return entities[match] || match;\n    }).substring(0, 1000) // 限制长度\n    ;\n}\n// 🔍 文件名安全验证\nfunction validateFileName(filename) {\n    const dangerousChars = /[<>:\"/\\\\|?*\\x00-\\x1f]/g;\n    const reservedNames = /^(CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])(\\.|$)/i;\n    return !dangerousChars.test(filename) && !reservedNames.test(filename) && filename.length <= 255 && !filename.includes('..');\n}\n// 🔍 URL安全验证\nfunction validateUrl(url) {\n    try {\n        const urlObj = new URL(url);\n        const allowedProtocols = [\n            'http:',\n            'https:'\n        ];\n        const allowedDomains = [\n            'remove-watermark-ai.com',\n            'replicate.com',\n            'api.replicate.com',\n            'fal.ai',\n            'supabase.co'\n        ];\n        return allowedProtocols.includes(urlObj.protocol) && allowedDomains.some((domain)=>urlObj.hostname.endsWith(domain));\n    } catch  {\n        return false;\n    }\n}\n// 🔍 图片数据验证\nfunction validateImageData(data) {\n    const bytes = new Uint8Array(data);\n    // 检查文件大小\n    if (bytes.length === 0 || bytes.length > 5 * 1024 * 1024) {\n        return false;\n    }\n    // 检查文件头\n    const headers = {\n        jpeg: [\n            0xFF,\n            0xD8,\n            0xFF\n        ],\n        png: [\n            0x89,\n            0x50,\n            0x4E,\n            0x47\n        ],\n        webp: [\n            0x52,\n            0x49,\n            0x46,\n            0x46\n        ],\n        gif: [\n            0x47,\n            0x49,\n            0x46,\n            0x38\n        ]\n    };\n    const isValidHeader = Object.values(headers).some((header)=>header.every((byte, index)=>bytes[index] === byte));\n    return isValidHeader;\n}\n// 🔍 速率限制检查\nclass RateLimiter {\n    checkLimit(key, limit, windowMs) {\n        const now = Date.now();\n        const record = this.requests.get(key);\n        if (!record || now > record.resetTime) {\n            this.requests.set(key, {\n                count: 1,\n                resetTime: now + windowMs\n            });\n            return true;\n        }\n        if (record.count >= limit) {\n            return false;\n        }\n        record.count++;\n        return true;\n    }\n    clear() {\n        this.requests.clear();\n    }\n    constructor(){\n        this.requests = new Map();\n    }\n}\n// 🔍 通用验证函数\nfunction validateInput(data, schema) {\n    try {\n        const result = schema.safeParse(data);\n        if (result.success) {\n            return {\n                isValid: true,\n                errors: [],\n                sanitizedData: result.data\n            };\n        } else {\n            return {\n                isValid: false,\n                errors: result.error.errors.map((err)=>err.message)\n            };\n        }\n    } catch (error) {\n        return {\n            isValid: false,\n            errors: [\n                '验证过程中发生错误'\n            ]\n        };\n    }\n}\n// 🔍 安全检查中间件\nfunction createSecurityMiddleware() {\n    return {\n        validateRequest: (req)=>{\n            const headers = req.headers;\n            // 检查Content-Type\n            const contentType = headers.get('content-type');\n            if (contentType && !contentType.includes('application/json') && !contentType.includes('multipart/form-data')) {\n                return {\n                    isValid: false,\n                    error: '不支持的Content-Type'\n                };\n            }\n            // 检查User-Agent\n            const userAgent = headers.get('user-agent');\n            if (!userAgent || userAgent.length > 500) {\n                return {\n                    isValid: false,\n                    error: '无效的User-Agent'\n                };\n            }\n            return {\n                isValid: true\n            };\n        },\n        validateFileUpload: (file)=>{\n            const validation = validateInput(file, fileSchema);\n            if (!validation.isValid) {\n                return {\n                    isValid: false,\n                    errors: validation.errors\n                };\n            }\n            if (!validateFileName(file.name)) {\n                return {\n                    isValid: false,\n                    errors: [\n                        '文件名包含危险字符'\n                    ]\n                };\n            }\n            return {\n                isValid: true\n            };\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlY3VyaXR5L2lucHV0LXZhbGlkYXRpb24udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF1QjtBQUV2QixpQkFBaUI7QUFFakIsU0FBUztBQUNGLE1BQU1DLGNBQWNELHlDQUFRLEdBQUdHLEtBQUssQ0FBQyxXQUFXQyxHQUFHLENBQUMsS0FBSyxVQUFTO0FBQ2xFLE1BQU1DLGlCQUFpQkwseUNBQVEsR0FBR00sR0FBRyxDQUFDLEdBQUcsVUFBVUYsR0FBRyxDQUFDLEtBQUssUUFBTztBQUNuRSxNQUFNRyxhQUFhUCx5Q0FBUSxHQUFHTSxHQUFHLENBQUMsR0FBRyxVQUFVRixHQUFHLENBQUMsS0FBSyxRQUFPO0FBRXRFLFNBQVM7QUFDRixNQUFNSSxhQUFhUix5Q0FBUSxDQUFDO0lBQ2pDVSxNQUFNVix5Q0FBUSxHQUFHSSxHQUFHLENBQUMsSUFBSSxPQUFPLE1BQU07SUFDdENRLE1BQU1aLHlDQUFRLEdBQUdhLE1BQU0sQ0FDckIsQ0FBQ0QsT0FBUztZQUFDO1lBQWM7WUFBYTtZQUFjO1NBQVksQ0FBQ0UsUUFBUSxDQUFDRixPQUMxRTtJQUVGRyxNQUFNZix5Q0FBUSxHQUFHSSxHQUFHLENBQUMsS0FBSztBQUM1QixHQUFFO0FBRUYsV0FBVztBQUNKLE1BQU1ZLHdCQUF3QmhCLHlDQUFRLENBQUM7SUFDNUNpQixRQUFRakIsMENBQU0sQ0FBQztRQUFDO1FBQVU7S0FBVSxFQUFFO1FBQUVtQixVQUFVLElBQU87Z0JBQUVDLFNBQVM7WUFBVTtJQUFHO0lBQ2pGQyxNQUFNYjtBQUNSLEdBQUU7QUFFRixTQUFTO0FBQ0YsTUFBTWMsaUJBQWlCdEIseUNBQVEsQ0FBQztJQUNyQ3VCLFVBQVV2Qix5Q0FBUSxHQUNmTSxHQUFHLENBQUMsR0FBRyxZQUNQRixHQUFHLENBQUMsTUFBTSxrQkFDVlMsTUFBTSxDQUNMLENBQUNXLE9BQVMsQ0FBQ0MsMEJBQTBCRCxPQUNyQztBQUVOLEdBQUU7QUFFRixPQUFPO0FBQ0EsTUFB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ZSxDQUFDQSxZQUFZMUYsUUFBUSxDQUFDLHVCQUF1QixDQUFDMEYsWUFBWTFGLFFBQVEsQ0FBQyx3QkFBd0I7Z0JBQzVHLE9BQU87b0JBQUVpRixTQUFTO29CQUFPRyxPQUFPO2dCQUFtQjtZQUNyRDtZQUVBLGVBQWU7WUFDZixNQUFNTyxZQUFZMUMsUUFBUXFCLEdBQUcsQ0FBQztZQUM5QixJQUFJLENBQUNxQixhQUFhQSxVQUFVekQsTUFBTSxHQUFHLEtBQUs7Z0JBQ3hDLE9BQU87b0JBQUUrQyxTQUFTO29CQUFPRyxPQUFPO2dCQUFnQjtZQUNsRDtZQUVBLE9BQU87Z0JBQUVILFNBQVM7WUFBSztRQUN6QjtRQUVBVyxvQkFBb0IsQ0FBQ3JGO1lBQ25CLE1BQU1zRixhQUFhakIsY0FBY3JFLE1BQU1iO1lBQ3ZDLElBQUksQ0FBQ21HLFdBQVdaLE9BQU8sRUFBRTtnQkFDdkIsT0FBTztvQkFBRUEsU0FBUztvQkFBT0MsUUFBUVcsV0FBV1gsTUFBTTtnQkFBQztZQUNyRDtZQUVBLElBQUksQ0FBQ3BELGlCQUFpQnZCLEtBQUtOLElBQUksR0FBRztnQkFDaEMsT0FBTztvQkFBRWdGLFNBQVM7b0JBQU9DLFFBQVE7d0JBQUM7cUJBQVk7Z0JBQUM7WUFDakQ7WUFFQSxPQUFPO2dCQUFFRCxTQUFTO1lBQUs7UUFDekI7SUFDRjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvdHV0dS9EZXNrdG9wL0JlIGEgRGV2ZWxvcGVyL215LWFpLXRvb2wtcHJvamVjdC9zcmMvbGliL3NlY3VyaXR5L2lucHV0LXZhbGlkYXRpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCdcblxuLy8g8J+UkCDovpPlhaXpqozor4Hlkozlronlhajmo4Dmn6XmqKHlnZdcblxuLy8g5Z+656GA6aqM6K+B5qih5byPXG5leHBvcnQgY29uc3QgZW1haWxTY2hlbWEgPSB6LnN0cmluZygpLmVtYWlsKCfml6DmlYjnmoTpgq7nrrHmoLzlvI8nKS5tYXgoMjU0LCAn6YKu566x5Zyw5Z2A6L+H6ZW/JylcbmV4cG9ydCBjb25zdCBwYXNzd29yZFNjaGVtYSA9IHouc3RyaW5nKCkubWluKDgsICflr4bnoIHoh7PlsJE45L2NJykubWF4KDEyOCwgJ+Wvhueggei/h+mVvycpXG5leHBvcnQgY29uc3QgbmFtZVNjaGVtYSA9IHouc3RyaW5nKCkubWluKDEsICflp5PlkI3kuI3og73kuLrnqbonKS5tYXgoMTAwLCAn5aeT5ZCN6L+H6ZW/JylcblxuLy8g5paH5Lu25LiK5Lyg6aqM6K+BXG5leHBvcnQgY29uc3QgZmlsZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgc2l6ZTogei5udW1iZXIoKS5tYXgoNSAqIDEwMjQgKiAxMDI0LCAn5paH5Lu25aSn5bCP5LiN6IO96LaF6L+HNU1CJyksIC8vIDVNQumZkOWItlxuICB0eXBlOiB6LnN0cmluZygpLnJlZmluZShcbiAgICAodHlwZSkgPT4gWydpbWFnZS9qcGVnJywgJ2ltYWdlL3BuZycsICdpbWFnZS93ZWJwJywgJ2ltYWdlL2dpZiddLmluY2x1ZGVzKHR5cGUpLFxuICAgICflj6rmlK/mjIEgSlBHLCBQTkcsIFdFQlAsIEdJRiDmoLzlvI8nXG4gICksXG4gIG5hbWU6IHouc3RyaW5nKCkubWF4KDI1NSwgJ+aWh+S7tuWQjei/h+mVvycpXG59KVxuXG4vLyDlm77niYflpITnkIbor7fmsYLpqozor4FcbmV4cG9ydCBjb25zdCBpbWFnZVByb2Nlc3NpbmdTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGFjdGlvbjogei5lbnVtKFsncmVtb3ZlJywgJ2VuaGFuY2UnXSwgeyBlcnJvck1hcDogKCkgPT4gKHsgbWVzc2FnZTogJ+aXoOaViOeahOaTjeS9nOexu+WeiycgfSkgfSksXG4gIGZpbGU6IGZpbGVTY2hlbWFcbn0pXG5cbi8vIOeUqOaIt+WPjemmiOmqjOivgVxuZXhwb3J0IGNvbnN0IGZlZWRiYWNrU2NoZW1hID0gei5vYmplY3Qoe1xuICBmZWVkYmFjazogei5zdHJpbmcoKVxuICAgIC5taW4oMSwgJ+WPjemmiOWGheWuueS4jeiDveS4uuepuicpXG4gICAgLm1heCgxMDAwLCAn5Y+N6aaI5YaF5a655LiN6IO96LaF6L+HMTAwMOWtl+espicpXG4gICAgLnJlZmluZShcbiAgICAgICh0ZXh0KSA9PiAhY29udGFpbnNTdXNwaWNpb3VzQ29udGVudCh0ZXh0KSxcbiAgICAgICflj43ppojlhoXlrrnljIXlkKvkuI3lvZPlhoXlrrknXG4gICAgKVxufSlcblxuLy8g5pSv5LuY6aqM6K+BXG5leHBvcnQgY29uc3QgcGF5bWVudFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgYW1vdW50OiB6Lm51bWJlcigpLnBvc2l0aXZlKCfph5Hpop3lv4XpobvkuLrmraPmlbAnKS5tYXgoMTAwMDAsICfph5Hpop3ov4flpKcnKSxcbiAgY3VycmVuY3k6IHouZW51bShbJ1VTRCcsICdFVVInLCAnQ05ZJ10sIHsgZXJyb3JNYXA6ICgpID0+ICh7IG1lc3NhZ2U6ICfkuI3mlK/mjIHnmoTotKfluIHnsbvlnosnIH0pIH0pLFxuICBwcm9kdWN0SWQ6IHouc3RyaW5nKCkubWluKDEsICfkuqflk4FJROS4jeiDveS4uuepuicpLm1heCgxMDAsICfkuqflk4FJROi/h+mVvycpLFxuICB1c2VySWQ6IHouc3RyaW5nKCkudXVpZCgn5peg5pWI55qE55So5oi3SUQnKVxufSlcblxuLy8g8J+UjSDlj6/nlpHlhoXlrrnmo4DmtYtcbmV4cG9ydCBmdW5jdGlvbiBjb250YWluc1N1c3BpY2lvdXNDb250ZW50KHRleHQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCBzdXNwaWNpb3VzUGF0dGVybnMgPSBbXG4gICAgLy8gU1FM5rOo5YWl5qih5byPXG4gICAgLyhcXGIodW5pb258c2VsZWN0fGluc2VydHx1cGRhdGV8ZGVsZXRlfGRyb3B8Y3JlYXRlfGFsdGVyKVxcYikvaSxcbiAgICAvKFxcYihzY3JpcHR8amF2YXNjcmlwdHx2YnNjcmlwdHxleHByZXNzaW9uKVxcYikvaSxcbiAgICAvKFxcYihvbmxvYWR8b25lcnJvcnxvbmNsaWNrfG9ubW91c2VvdmVyKVxcYikvaSxcbiAgICBcbiAgICAvLyBYU1PmqKHlvI9cbiAgICAvPHNjcmlwdFxcYltePF0qKD86KD8hPFxcL3NjcmlwdD4pPFtePF0qKSo8XFwvc2NyaXB0Pi9naSxcbiAgICAvamF2YXNjcmlwdDovZ2ksXG4gICAgL3Zic2NyaXB0Oi9naSxcbiAgICAvb25cXHcrXFxzKj0vZ2ksXG4gICAgXG4gICAgLy8g5ZG95Luk5rOo5YWl5qih5byPXG4gICAgLyhcXGIoY21kfGNvbW1hbmR8ZXhlY3xzeXN0ZW18c2hlbGwpXFxiKS9pLFxuICAgIC9bOyZ8YCQoKXt9W1xcXV0vZyxcbiAgICBcbiAgICAvLyDot6/lvoTpgY3ljoZcbiAgICAvXFwuXFwuXFwvL2csXG4gICAgL1xcLlxcLlxcXFwvZyxcbiAgICBcbiAgICAvLyDnibnmrorlrZfnrKbov4flpJpcbiAgICAvWzw+XFxcIicmXXszLH0vZ1xuICBdXG4gIFxuICByZXR1cm4gc3VzcGljaW91c1BhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QodGV4dCkpXG59XG5cbi8vIPCflI0g6L6T5YWl5riF55CGXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVJbnB1dChpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIGlucHV0XG4gICAgLnRyaW0oKVxuICAgIC5yZXBsYWNlKC9bPD5cXFwiJyZdL2csIChtYXRjaCkgPT4ge1xuICAgICAgY29uc3QgZW50aXRpZXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7XG4gICAgICAgICc8JzogJyZsdDsnLFxuICAgICAgICAnPic6ICcmZ3Q7JyxcbiAgICAgICAgJ1wiJzogJyZxdW90OycsXG4gICAgICAgIFwiJ1wiOiAnJiN4Mjc7JyxcbiAgICAgICAgJyYnOiAnJmFtcDsnXG4gICAgICB9XG4gICAgICByZXR1cm4gZW50aXRpZXNbbWF0Y2hdIHx8IG1hdGNoXG4gICAgfSlcbiAgICAuc3Vic3RyaW5nKDAsIDEwMDApIC8vIOmZkOWItumVv+W6plxufVxuXG4vLyDwn5SNIOaWh+S7tuWQjeWuieWFqOmqjOivgVxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRmlsZU5hbWUoZmlsZW5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCBkYW5nZXJvdXNDaGFycyA9IC9bPD46XCIvXFxcXHw/KlxceDAwLVxceDFmXS9nXG4gIGNvbnN0IHJlc2VydmVkTmFtZXMgPSAvXihDT058UFJOfEFVWHxOVUx8Q09NWzEtOV18TFBUWzEtOV0pKFxcLnwkKS9pXG4gIFxuICByZXR1cm4gIWRhbmdlcm91c0NoYXJzLnRlc3QoZmlsZW5hbWUpICYmIFxuICAgICAgICAgIXJlc2VydmVkTmFtZXMudGVzdChmaWxlbmFtZSkgJiYgXG4gICAgICAgICBmaWxlbmFtZS5sZW5ndGggPD0gMjU1ICYmXG4gICAgICAgICAhZmlsZW5hbWUuaW5jbHVkZXMoJy4uJylcbn1cblxuLy8g8J+UjSBVUkzlronlhajpqozor4FcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVVybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICB0cnkge1xuICAgIGNvbnN0IHVybE9iaiA9IG5ldyBVUkwodXJsKVxuICAgIGNvbnN0IGFsbG93ZWRQcm90b2NvbHMgPSBbJ2h0dHA6JywgJ2h0dHBzOiddXG4gICAgY29uc3QgYWxsb3dlZERvbWFpbnMgPSBbXG4gICAgICAncmVtb3ZlLXdhdGVybWFyay1haS5jb20nLFxuICAgICAgJ3JlcGxpY2F0ZS5jb20nLFxuICAgICAgJ2FwaS5yZXBsaWNhdGUuY29tJyxcbiAgICAgICdmYWwuYWknLFxuICAgICAgJ3N1cGFiYXNlLmNvJ1xuICAgIF1cbiAgICBcbiAgICByZXR1cm4gYWxsb3dlZFByb3RvY29scy5pbmNsdWRlcyh1cmxPYmoucHJvdG9jb2wpICYmXG4gICAgICAgICAgIGFsbG93ZWREb21haW5zLnNvbWUoZG9tYWluID0+IHVybE9iai5ob3N0bmFtZS5lbmRzV2l0aChkb21haW4pKVxuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuXG4vLyDwn5SNIOWbvueJh+aVsOaNrumqjOivgVxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlSW1hZ2VEYXRhKGRhdGE6IEFycmF5QnVmZmVyKTogYm9vbGVhbiB7XG4gIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSlcbiAgXG4gIC8vIOajgOafpeaWh+S7tuWkp+Wwj1xuICBpZiAoYnl0ZXMubGVuZ3RoID09PSAwIHx8IGJ5dGVzLmxlbmd0aCA+IDUgKiAxMDI0ICogMTAyNCkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIFxuICAvLyDmo4Dmn6Xmlofku7blpLRcbiAgY29uc3QgaGVhZGVycyA9IHtcbiAgICBqcGVnOiBbMHhGRiwgMHhEOCwgMHhGRl0sXG4gICAgcG5nOiBbMHg4OSwgMHg1MCwgMHg0RSwgMHg0N10sXG4gICAgd2VicDogWzB4NTIsIDB4NDksIDB4NDYsIDB4NDZdLFxuICAgIGdpZjogWzB4NDcsIDB4NDksIDB4NDYsIDB4MzhdXG4gIH1cbiAgXG4gIGNvbnN0IGlzVmFsaWRIZWFkZXIgPSBPYmplY3QudmFsdWVzKGhlYWRlcnMpLnNvbWUoaGVhZGVyID0+XG4gICAgaGVhZGVyLmV2ZXJ5KChieXRlLCBpbmRleCkgPT4gYnl0ZXNbaW5kZXhdID09PSBieXRlKVxuICApXG4gIFxuICByZXR1cm4gaXNWYWxpZEhlYWRlclxufVxuXG4vLyDwn5SNIOmAn+eOh+mZkOWItuajgOafpVxuZXhwb3J0IGNsYXNzIFJhdGVMaW1pdGVyIHtcbiAgcHJpdmF0ZSByZXF1ZXN0cyA9IG5ldyBNYXA8c3RyaW5nLCB7IGNvdW50OiBudW1iZXI7IHJlc2V0VGltZTogbnVtYmVyIH0+KClcbiAgXG4gIGNoZWNrTGltaXQoa2V5OiBzdHJpbmcsIGxpbWl0OiBudW1iZXIsIHdpbmRvd01zOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpXG4gICAgY29uc3QgcmVjb3JkID0gdGhpcy5yZXF1ZXN0cy5nZXQoa2V5KVxuICAgIFxuICAgIGlmICghcmVjb3JkIHx8IG5vdyA+IHJlY29yZC5yZXNldFRpbWUpIHtcbiAgICAgIHRoaXMucmVxdWVzdHMuc2V0KGtleSwgeyBjb3VudDogMSwgcmVzZXRUaW1lOiBub3cgKyB3aW5kb3dNcyB9KVxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgXG4gICAgaWYgKHJlY29yZC5jb3VudCA+PSBsaW1pdCkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIFxuICAgIHJlY29yZC5jb3VudCsrXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICBcbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5yZXF1ZXN0cy5jbGVhcigpXG4gIH1cbn1cblxuLy8g8J+UjSDpqozor4Hnu5PmnpznsbvlnotcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvblJlc3VsdCB7XG4gIGlzVmFsaWQ6IGJvb2xlYW5cbiAgZXJyb3JzOiBzdHJpbmdbXVxuICBzYW5pdGl6ZWREYXRhPzogYW55XG59XG5cbi8vIPCflI0g6YCa55So6aqM6K+B5Ye95pWwXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVJbnB1dDxUPihcbiAgZGF0YTogYW55LFxuICBzY2hlbWE6IHouWm9kU2NoZW1hPFQ+XG4pOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBzY2hlbWEuc2FmZVBhcnNlKGRhdGEpXG4gICAgXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgICBlcnJvcnM6IFtdLFxuICAgICAgICBzYW5pdGl6ZWREYXRhOiByZXN1bHQuZGF0YVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3JzOiByZXN1bHQuZXJyb3IuZXJyb3JzLm1hcChlcnIgPT4gZXJyLm1lc3NhZ2UpXG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgIGVycm9yczogWyfpqozor4Hov4fnqIvkuK3lj5HnlJ/plJnor68nXVxuICAgIH1cbiAgfVxufVxuXG4vLyDwn5SNIOWuieWFqOajgOafpeS4remXtOS7tlxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNlY3VyaXR5TWlkZGxld2FyZSgpIHtcbiAgcmV0dXJuIHtcbiAgICB2YWxpZGF0ZVJlcXVlc3Q6IChyZXE6IFJlcXVlc3QpID0+IHtcbiAgICAgIGNvbnN0IGhlYWRlcnMgPSByZXEuaGVhZGVyc1xuICAgICAgXG4gICAgICAvLyDmo4Dmn6VDb250ZW50LVR5cGVcbiAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gaGVhZGVycy5nZXQoJ2NvbnRlbnQtdHlwZScpXG4gICAgICBpZiAoY29udGVudFR5cGUgJiYgIWNvbnRlbnRUeXBlLmluY2x1ZGVzKCdhcHBsaWNhdGlvbi9qc29uJykgJiYgIWNvbnRlbnRUeXBlLmluY2x1ZGVzKCdtdWx0aXBhcnQvZm9ybS1kYXRhJykpIHtcbiAgICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIGVycm9yOiAn5LiN5pSv5oyB55qEQ29udGVudC1UeXBlJyB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOajgOafpVVzZXItQWdlbnRcbiAgICAgIGNvbnN0IHVzZXJBZ2VudCA9IGhlYWRlcnMuZ2V0KCd1c2VyLWFnZW50JylcbiAgICAgIGlmICghdXNlckFnZW50IHx8IHVzZXJBZ2VudC5sZW5ndGggPiA1MDApIHtcbiAgICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIGVycm9yOiAn5peg5pWI55qEVXNlci1BZ2VudCcgfVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlIH1cbiAgICB9LFxuICAgIFxuICAgIHZhbGlkYXRlRmlsZVVwbG9hZDogKGZpbGU6IEZpbGUpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZUlucHV0KGZpbGUsIGZpbGVTY2hlbWEpXG4gICAgICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3JzOiB2YWxpZGF0aW9uLmVycm9ycyB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICghdmFsaWRhdGVGaWxlTmFtZShmaWxlLm5hbWUpKSB7XG4gICAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnM6IFsn5paH5Lu25ZCN5YyF5ZCr5Y2x6Zmp5a2X56ymJ10gfVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlIH1cbiAgICB9XG4gIH1cbn0gIl0sIm5hbWVzIjpbInoiLCJlbWFpbFNjaGVtYSIsInN0cmluZyIsImVtYWlsIiwibWF4IiwicGFzc3dvcmRTY2hlbWEiLCJtaW4iLCJuYW1lU2NoZW1hIiwiZmlsZVNjaGVtYSIsIm9iamVjdCIsInNpemUiLCJudW1iZXIiLCJ0eXBlIiwicmVmaW5lIiwiaW5jbHVkZXMiLCJuYW1lIiwiaW1hZ2VQcm9jZXNzaW5nU2NoZW1hIiwiYWN0aW9uIiwiZW51bSIsImVycm9yTWFwIiwibWVzc2FnZSIsImZpbGUiLCJmZWVkYmFja1NjaGVtYSIsImZlZWRiYWNrIiwidGV4dCIsImNvbnRhaW5zU3VzcGljaW91c0NvbnRlbnQiLCJwYXltZW50U2NoZW1hIiwiYW1vdW50IiwicG9zaXRpdmUiLCJjdXJyZW5jeSIsInByb2R1Y3RJZCIsInVzZXJJZCIsInV1aWQiLCJzdXNwaWNpb3VzUGF0dGVybnMiLCJzb21lIiwicGF0dGVybiIsInRlc3QiLCJzYW5pdGl6ZUlucHV0IiwiaW5wdXQiLCJ0cmltIiwicmVwbGFjZSIsIm1hdGNoIiwiZW50aXRpZXMiLCJzdWJzdHJpbmciLCJ2YWxpZGF0ZUZpbGVOYW1lIiwiZmlsZW5hbWUiLCJkYW5nZXJvdXNDaGFycyIsInJlc2VydmVkTmFtZXMiLCJsZW5ndGgiLCJ2YWxpZGF0ZVVybCIsInVybCIsInVybE9iaiIsIlVSTCIsImFsbG93ZWRQcm90b2NvbHMiLCJhbGxvd2VkRG9tYWlucyIsInByb3RvY29sIiwiZG9tYWluIiwiaG9zdG5hbWUiLCJlbmRzV2l0aCIsInZhbGlkYXRlSW1hZ2VEYXRhIiwiZGF0YSIsImJ5dGVzIiwiVWludDhBcnJheSIsImhlYWRlcnMiLCJqcGVnIiwicG5nIiwid2VicCIsImdpZiIsImlzVmFsaWRIZWFkZXIiLCJPYmplY3QiLCJ2YWx1ZXMiLCJoZWFkZXIiLCJldmVyeSIsImJ5dGUiLCJpbmRleCIsIlJhdGVMaW1pdGVyIiwiY2hlY2tMaW1pdCIsImtleSIsImxpbWl0Iiwid2luZG93TXMiLCJub3ciLCJEYXRlIiwicmVjb3JkIiwicmVxdWVzdHMiLCJnZXQiLCJyZXNldFRpbWUiLCJzZXQiLCJjb3VudCIsImNsZWFyIiwiTWFwIiwidmFsaWRhdGVJbnB1dCIsInNjaGVtYSIsInJlc3VsdCIsInNhZmVQYXJzZSIsInN1Y2Nlc3MiLCJpc1ZhbGlkIiwiZXJyb3JzIiwic2FuaXRpemVkRGF0YSIsImVycm9yIiwibWFwIiwiZXJyIiwiY3JlYXRlU2VjdXJpdHlNaWRkbGV3YXJlIiwidmFsaWRhdGVSZXF1ZXN0IiwicmVxIiwiY29udGVudFR5cGUiLCJ1c2VyQWdlbnQiLCJ2YWxpZGF0ZUZpbGVVcGxvYWQiLCJ2YWxpZGF0aW9uIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/security/input-validation.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/utils/error-handler.ts":
/*!****************************************!*\
  !*** ./src/lib/utils/error-handler.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthenticationError: () => (/* binding */ AuthenticationError),\n/* harmony export */   AuthorizationError: () => (/* binding */ AuthorizationError),\n/* harmony export */   FileUploadError: () => (/* binding */ FileUploadError),\n/* harmony export */   RateLimitError: () => (/* binding */ RateLimitError),\n/* harmony export */   ValidationError: () => (/* binding */ ValidationError),\n/* harmony export */   createErrorResponse: () => (/* binding */ createErrorResponse),\n/* harmony export */   createSecurityMiddleware: () => (/* binding */ createSecurityMiddleware),\n/* harmony export */   logSecurityEvent: () => (/* binding */ logSecurityEvent),\n/* harmony export */   secureResponse: () => (/* binding */ secureResponse),\n/* harmony export */   withErrorHandling: () => (/* binding */ withErrorHandling)\n/* harmony export */ });\n// 🔐 统一错误处理和安全日志模块\n// 生成请求ID\nfunction generateRequestId() {\n    return `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n// 获取用户代理\nfunction getUserAgent(req) {\n    if (req) {\n        return req.headers.get('user-agent') || 'unknown';\n    }\n    return 'unknown';\n}\n// 从请求中获取客户端IP\nasync function getClientIpFromRequest(req) {\n    if (!req) return 'unknown';\n    try {\n        const forwardedFor = req.headers.get('x-forwarded-for');\n        const realIp = req.headers.get('x-real-ip');\n        const cfConnectingIp = req.headers.get('cf-connecting-ip');\n        const xClientIp = req.headers.get('x-client-ip');\n        if (cfConnectingIp) return cfConnectingIp;\n        if (realIp) return realIp;\n        if (forwardedFor) return forwardedFor.split(',')[0].trim();\n        if (xClientIp) return xClientIp;\n        return 'unknown';\n    } catch  {\n        return 'unknown';\n    }\n}\n// 创建统一错误响应\nfunction createErrorResponse(error, status = 500, req) {\n    const isDev = \"development\" === 'development';\n    const errorMessage = typeof error === 'string' ? error : error.message;\n    // 记录安全事件\n    logSecurityEvent('error_response', {\n        status,\n        error: isDev ? errorMessage : 'Internal server error',\n        ip: 'unknown',\n        userAgent: getUserAgent(req),\n        timestamp: new Date().toISOString()\n    });\n    return Response.json({\n        error: isDev ? errorMessage : 'Internal server error',\n        status,\n        timestamp: new Date().toISOString(),\n        requestId: generateRequestId()\n    }, {\n        status\n    });\n}\n// 记录安全事件\nfunction logSecurityEvent(event, details) {\n    const logData = {\n        event,\n        timestamp: new Date().toISOString(),\n        environment: \"development\" || 0,\n        ...details\n    };\n    // 开发环境输出到控制台\n    if (true) {\n        console.log(`🔒 Security Event: ${event}`, logData);\n    } else {}\n}\n// 验证错误\nclass ValidationError extends Error {\n    constructor(message, field){\n        super(message), this.field = field;\n        this.name = 'ValidationError';\n    }\n}\n// 认证错误\nclass AuthenticationError extends Error {\n    constructor(message = 'Authentication required'){\n        super(message);\n        this.name = 'AuthenticationError';\n    }\n}\n// 权限错误\nclass AuthorizationError extends Error {\n    constructor(message = 'Insufficient permissions'){\n        super(message);\n        this.name = 'AuthorizationError';\n    }\n}\n// 速率限制错误\nclass RateLimitError extends Error {\n    constructor(message = 'Rate limit exceeded'){\n        super(message);\n        this.name = 'RateLimitError';\n    }\n}\n// 文件上传错误\nclass FileUploadError extends Error {\n    constructor(message, file){\n        super(message), this.file = file;\n        this.name = 'FileUploadError';\n    }\n}\n// 安全检查中间件\nfunction createSecurityMiddleware() {\n    return {\n        // 验证请求头\n        validateHeaders: (req)=>{\n            const headers = req.headers;\n            // 检查Content-Type\n            const contentType = headers.get('content-type');\n            if (contentType && !contentType.includes('application/json') && !contentType.includes('multipart/form-data')) {\n                return {\n                    isValid: false,\n                    error: '不支持的Content-Type'\n                };\n            }\n            // 检查User-Agent\n            const userAgent = headers.get('user-agent');\n            if (!userAgent || userAgent.length > 500) {\n                return {\n                    isValid: false,\n                    error: '无效的User-Agent'\n                };\n            }\n            // 检查请求大小\n            const contentLength = headers.get('content-length');\n            if (contentLength && parseInt(contentLength) > 10 * 1024 * 1024) {\n                return {\n                    isValid: false,\n                    error: '请求体过大'\n                };\n            }\n            return {\n                isValid: true\n            };\n        },\n        // 记录请求\n        logRequest: async (req, response)=>{\n            const url = new URL(req.url);\n            const method = req.method;\n            const ip = await getClientIpFromRequest(req);\n            const userAgent = getUserAgent(req);\n            // 记录可疑请求\n            const suspiciousPatterns = [\n                /\\.\\.\\//,\n                /<script/i,\n                /union.*select/i,\n                /javascript:/i,\n                /on\\w+\\s*=/i // 事件处理器\n            ];\n            const isSuspicious = suspiciousPatterns.some((pattern)=>pattern.test(url.pathname) || pattern.test(url.search) || pattern.test(userAgent));\n            if (isSuspicious) {\n                logSecurityEvent('suspicious_request', {\n                    method,\n                    path: url.pathname,\n                    query: url.search,\n                    ip,\n                    userAgent,\n                    status: response?.status || 'unknown'\n                });\n            }\n        }\n    };\n}\n// 错误处理装饰器\nfunction withErrorHandling(handler) {\n    return async (...args)=>{\n        try {\n            return await handler(...args);\n        } catch (error) {\n            // 记录错误\n            logSecurityEvent('unhandled_error', {\n                error: error instanceof Error ? error.message : String(error),\n                stack: error instanceof Error ? error.stack : undefined\n            });\n            // 重新抛出错误\n            throw error;\n        }\n    };\n}\n// 安全响应包装器\nfunction secureResponse(response, req) {\n    // 添加安全头\n    response.headers.set('X-Content-Type-Options', 'nosniff');\n    response.headers.set('X-Frame-Options', 'DENY');\n    response.headers.set('X-XSS-Protection', '1; mode=block');\n    return response;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QW1CO0lBQ3hDcEIsU0FBU2pELE9BQU8sQ0FBQ3FFLEdBQUcsQ0FBQyxvQkFBb0I7SUFFekMsT0FBT3BCO0FBQ1QiLCJzb3VyY2VzIjpbIi9Vc2Vycy90dXR1L0Rlc2t0b3AvQmUgYSBEZXZlbG9wZXIvbXktYWktdG9vbC1wcm9qZWN0L3NyYy9saWIvdXRpbHMvZXJyb3ItaGFuZGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRDbGllbnRJcCB9IGZyb20gJy4vaXAnXG5cbi8vIPCflJAg57uf5LiA6ZSZ6K+v5aSE55CG5ZKM5a6J5YWo5pel5b+X5qih5Z2XXG5cbi8vIOeUn+aIkOivt+axgklEXG5mdW5jdGlvbiBnZW5lcmF0ZVJlcXVlc3RJZCgpOiBzdHJpbmcge1xuICByZXR1cm4gYHJlcV8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWBcbn1cblxuLy8g6I635Y+W55So5oi35Luj55CGXG5mdW5jdGlvbiBnZXRVc2VyQWdlbnQocmVxPzogUmVxdWVzdCk6IHN0cmluZyB7XG4gIGlmIChyZXEpIHtcbiAgICByZXR1cm4gcmVxLmhlYWRlcnMuZ2V0KCd1c2VyLWFnZW50JykgfHwgJ3Vua25vd24nXG4gIH1cbiAgcmV0dXJuICd1bmtub3duJ1xufVxuXG4vLyDku47or7fmsYLkuK3ojrflj5blrqLmiLfnq69JUFxuYXN5bmMgZnVuY3Rpb24gZ2V0Q2xpZW50SXBGcm9tUmVxdWVzdChyZXE/OiBSZXF1ZXN0KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgaWYgKCFyZXEpIHJldHVybiAndW5rbm93bidcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgZm9yd2FyZGVkRm9yID0gcmVxLmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKVxuICAgIGNvbnN0IHJlYWxJcCA9IHJlcS5oZWFkZXJzLmdldCgneC1yZWFsLWlwJylcbiAgICBjb25zdCBjZkNvbm5lY3RpbmdJcCA9IHJlcS5oZWFkZXJzLmdldCgnY2YtY29ubmVjdGluZy1pcCcpXG4gICAgY29uc3QgeENsaWVudElwID0gcmVxLmhlYWRlcnMuZ2V0KCd4LWNsaWVudC1pcCcpXG4gICAgXG4gICAgaWYgKGNmQ29ubmVjdGluZ0lwKSByZXR1cm4gY2ZDb25uZWN0aW5nSXBcbiAgICBpZiAocmVhbElwKSByZXR1cm4gcmVhbElwXG4gICAgaWYgKGZvcndhcmRlZEZvcikgcmV0dXJuIGZvcndhcmRlZEZvci5zcGxpdCgnLCcpWzBdLnRyaW0oKVxuICAgIGlmICh4Q2xpZW50SXApIHJldHVybiB4Q2xpZW50SXBcbiAgICBcbiAgICByZXR1cm4gJ3Vua25vd24nXG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiAndW5rbm93bidcbiAgfVxufVxuXG4vLyDliJvlu7rnu5/kuIDplJnor6/lk43lupRcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFcnJvclJlc3BvbnNlKFxuICBlcnJvcjogRXJyb3IgfCBzdHJpbmcsIFxuICBzdGF0dXM6IG51bWJlciA9IDUwMCxcbiAgcmVxPzogUmVxdWVzdFxuKTogUmVzcG9uc2Uge1xuICBjb25zdCBpc0RldiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnXG4gIGNvbnN0IGVycm9yTWVzc2FnZSA9IHR5cGVvZiBlcnJvciA9PT0gJ3N0cmluZycgPyBlcnJvciA6IGVycm9yLm1lc3NhZ2VcbiAgXG4gIC8vIOiusOW9leWuieWFqOS6i+S7tlxuICBsb2dTZWN1cml0eUV2ZW50KCdlcnJvcl9yZXNwb25zZScsIHtcbiAgICBzdGF0dXMsXG4gICAgZXJyb3I6IGlzRGV2ID8gZXJyb3JNZXNzYWdlIDogJ0ludGVybmFsIHNlcnZlciBlcnJvcicsXG4gICAgaXA6ICd1bmtub3duJywgLy8g5bCG5Zyo5byC5q2l5Ye95pWw5Lit5aSE55CGXG4gICAgdXNlckFnZW50OiBnZXRVc2VyQWdlbnQocmVxKSxcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICB9KVxuICBcbiAgcmV0dXJuIFJlc3BvbnNlLmpzb24oe1xuICAgIGVycm9yOiBpc0RldiA/IGVycm9yTWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxuICAgIHN0YXR1cyxcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICByZXF1ZXN0SWQ6IGdlbmVyYXRlUmVxdWVzdElkKClcbiAgfSwgeyBzdGF0dXMgfSlcbn1cblxuLy8g6K6w5b2V5a6J5YWo5LqL5Lu2XG5leHBvcnQgZnVuY3Rpb24gbG9nU2VjdXJpdHlFdmVudChldmVudDogc3RyaW5nLCBkZXRhaWxzOiBhbnkpOiB2b2lkIHtcbiAgY29uc3QgbG9nRGF0YSA9IHtcbiAgICBldmVudCxcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICBlbnZpcm9ubWVudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50JyxcbiAgICAuLi5kZXRhaWxzXG4gIH1cbiAgXG4gIC8vIOW8gOWPkeeOr+Wig+i+k+WHuuWIsOaOp+WItuWPsFxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICBjb25zb2xlLmxvZyhg8J+UkiBTZWN1cml0eSBFdmVudDogJHtldmVudH1gLCBsb2dEYXRhKVxuICB9IGVsc2Uge1xuICAgIC8vIOeUn+S6p+eOr+Wig+WPr+S7peWPkemAgeWIsOaXpeW/l+acjeWKoVxuICAgIGNvbnNvbGUubG9nKGDwn5SSIFNlY3VyaXR5IEV2ZW50OiAke2V2ZW50fWAsIHtcbiAgICAgIHRpbWVzdGFtcDogbG9nRGF0YS50aW1lc3RhbXAsXG4gICAgICBldmVudDogbG9nRGF0YS5ldmVudCxcbiAgICAgIGlwOiBsb2dEYXRhLmlwIHx8ICd1bmtub3duJ1xuICAgIH0pXG4gIH1cbn1cblxuLy8g6aqM6K+B6ZSZ6K+vXG5leHBvcnQgY2xhc3MgVmFsaWRhdGlvbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIHB1YmxpYyBmaWVsZD86IHN0cmluZykge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG4gICAgdGhpcy5uYW1lID0gJ1ZhbGlkYXRpb25FcnJvcidcbiAgfVxufVxuXG4vLyDorqTor4HplJnor69cbmV4cG9ydCBjbGFzcyBBdXRoZW50aWNhdGlvbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcgPSAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnKSB7XG4gICAgc3VwZXIobWVzc2FnZSlcbiAgICB0aGlzLm5hbWUgPSAnQXV0aGVudGljYXRpb25FcnJvcidcbiAgfVxufVxuXG4vLyDmnYPpmZDplJnor69cbmV4cG9ydCBjbGFzcyBBdXRob3JpemF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZyA9ICdJbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMnKSB7XG4gICAgc3VwZXIobWVzc2FnZSlcbiAgICB0aGlzLm5hbWUgPSAnQXV0aG9yaXphdGlvbkVycm9yJ1xuICB9XG59XG5cbi8vIOmAn+eOh+mZkOWItumUmeivr1xuZXhwb3J0IGNsYXNzIFJhdGVMaW1pdEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcgPSAnUmF0ZSBsaW1pdCBleGNlZWRlZCcpIHtcbiAgICBzdXBlcihtZXNzYWdlKVxuICAgIHRoaXMubmFtZSA9ICdSYXRlTGltaXRFcnJvcidcbiAgfVxufVxuXG4vLyDmlofku7bkuIrkvKDplJnor69cbmV4cG9ydCBjbGFzcyBGaWxlVXBsb2FkRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgcHVibGljIGZpbGU/OiBzdHJpbmcpIHtcbiAgICBzdXBlcihtZXNzYWdlKVxuICAgIHRoaXMubmFtZSA9ICdGaWxlVXBsb2FkRXJyb3InXG4gIH1cbn1cblxuLy8g5a6J5YWo5qOA5p+l5Lit6Ze05Lu2XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2VjdXJpdHlNaWRkbGV3YXJlKCkge1xuICByZXR1cm4ge1xuICAgIC8vIOmqjOivgeivt+axguWktFxuICAgIHZhbGlkYXRlSGVhZGVyczogKHJlcTogUmVxdWVzdCk6IHsgaXNWYWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSA9PiB7XG4gICAgICBjb25zdCBoZWFkZXJzID0gcmVxLmhlYWRlcnNcbiAgICAgIFxuICAgICAgLy8g5qOA5p+lQ29udGVudC1UeXBlXG4gICAgICBjb25zdCBjb250ZW50VHlwZSA9IGhlYWRlcnMuZ2V0KCdjb250ZW50LXR5cGUnKVxuICAgICAgaWYgKGNvbnRlbnRUeXBlICYmICFjb250ZW50VHlwZS5pbmNsdWRlcygnYXBwbGljYXRpb24vanNvbicpICYmICFjb250ZW50VHlwZS5pbmNsdWRlcygnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpKSB7XG4gICAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcjogJ+S4jeaUr+aMgeeahENvbnRlbnQtVHlwZScgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDmo4Dmn6VVc2VyLUFnZW50XG4gICAgICBjb25zdCB1c2VyQWdlbnQgPSBoZWFkZXJzLmdldCgndXNlci1hZ2VudCcpXG4gICAgICBpZiAoIXVzZXJBZ2VudCB8fCB1c2VyQWdlbnQubGVuZ3RoID4gNTAwKSB7XG4gICAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcjogJ+aXoOaViOeahFVzZXItQWdlbnQnIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g5qOA5p+l6K+35rGC5aSn5bCPXG4gICAgICBjb25zdCBjb250ZW50TGVuZ3RoID0gaGVhZGVycy5nZXQoJ2NvbnRlbnQtbGVuZ3RoJylcbiAgICAgIGlmIChjb250ZW50TGVuZ3RoICYmIHBhcnNlSW50KGNvbnRlbnRMZW5ndGgpID4gMTAgKiAxMDI0ICogMTAyNCkgeyAvLyAxME1CXG4gICAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcjogJ+ivt+axguS9k+i/h+WkpycgfVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlIH1cbiAgICB9LFxuICAgIFxuICAgIC8vIOiusOW9leivt+axglxuICAgIGxvZ1JlcXVlc3Q6IGFzeW5jIChyZXE6IFJlcXVlc3QsIHJlc3BvbnNlPzogUmVzcG9uc2UpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxLnVybClcbiAgICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2RcbiAgICAgIGNvbnN0IGlwID0gYXdhaXQgZ2V0Q2xpZW50SXBGcm9tUmVxdWVzdChyZXEpXG4gICAgICBjb25zdCB1c2VyQWdlbnQgPSBnZXRVc2VyQWdlbnQocmVxKVxuICAgICAgXG4gICAgICAvLyDorrDlvZXlj6/nlpHor7fmsYJcbiAgICAgIGNvbnN0IHN1c3BpY2lvdXNQYXR0ZXJucyA9IFtcbiAgICAgICAgL1xcLlxcLlxcLy8sIC8vIOi3r+W+hOmBjeWOhlxuICAgICAgICAvPHNjcmlwdC9pLCAvLyBYU1NcbiAgICAgICAgL3VuaW9uLipzZWxlY3QvaSwgLy8gU1FM5rOo5YWlXG4gICAgICAgIC9qYXZhc2NyaXB0Oi9pLCAvLyBKYXZhU2NyaXB05Y2P6K6uXG4gICAgICAgIC9vblxcdytcXHMqPS9pIC8vIOS6i+S7tuWkhOeQhuWZqFxuICAgICAgXVxuICAgICAgXG4gICAgICBjb25zdCBpc1N1c3BpY2lvdXMgPSBzdXNwaWNpb3VzUGF0dGVybnMuc29tZShwYXR0ZXJuID0+IFxuICAgICAgICBwYXR0ZXJuLnRlc3QodXJsLnBhdGhuYW1lKSB8fCBwYXR0ZXJuLnRlc3QodXJsLnNlYXJjaCkgfHwgcGF0dGVybi50ZXN0KHVzZXJBZ2VudClcbiAgICAgIClcbiAgICAgIFxuICAgICAgaWYgKGlzU3VzcGljaW91cykge1xuICAgICAgICBsb2dTZWN1cml0eUV2ZW50KCdzdXNwaWNpb3VzX3JlcXVlc3QnLCB7XG4gICAgICAgICAgbWV0aG9kLFxuICAgICAgICAgIHBhdGg6IHVybC5wYXRobmFtZSxcbiAgICAgICAgICBxdWVyeTogdXJsLnNlYXJjaCxcbiAgICAgICAgICBpcCxcbiAgICAgICAgICB1c2VyQWdlbnQsXG4gICAgICAgICAgc3RhdHVzOiByZXNwb25zZT8uc3RhdHVzIHx8ICd1bmtub3duJ1xuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vLyDplJnor6/lpITnkIboo4XppbDlmahcbmV4cG9ydCBmdW5jdGlvbiB3aXRoRXJyb3JIYW5kbGluZzxUIGV4dGVuZHMgYW55W10sIFI+KFxuICBoYW5kbGVyOiAoLi4uYXJnczogVCkgPT4gUHJvbWlzZTxSPlxuKTogKC4uLmFyZ3M6IFQpID0+IFByb21pc2U8Uj4ge1xuICByZXR1cm4gYXN5bmMgKC4uLmFyZ3M6IFQpOiBQcm9taXNlPFI+ID0+IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGhhbmRsZXIoLi4uYXJncylcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8g6K6w5b2V6ZSZ6K+vXG4gICAgICBsb2dTZWN1cml0eUV2ZW50KCd1bmhhbmRsZWRfZXJyb3InLCB7XG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvciksXG4gICAgICAgIHN0YWNrOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiB1bmRlZmluZWRcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIC8vIOmHjeaWsOaKm+WHuumUmeivr1xuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cbn1cblxuLy8g5a6J5YWo5ZON5bqU5YyF6KOF5ZmoXG5leHBvcnQgZnVuY3Rpb24gc2VjdXJlUmVzcG9uc2UocmVzcG9uc2U6IFJlc3BvbnNlLCByZXE/OiBSZXF1ZXN0KTogUmVzcG9uc2Uge1xuICAvLyDmt7vliqDlronlhajlpLRcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1gtQ29udGVudC1UeXBlLU9wdGlvbnMnLCAnbm9zbmlmZicpXG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdYLUZyYW1lLU9wdGlvbnMnLCAnREVOWScpXG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdYLVhTUy1Qcm90ZWN0aW9uJywgJzE7IG1vZGU9YmxvY2snKVxuICBcbiAgcmV0dXJuIHJlc3BvbnNlXG59ICJdLCJuYW1lcyI6WyJnZW5lcmF0ZVJlcXVlc3RJZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJnZXRVc2VyQWdlbnQiLCJyZXEiLCJoZWFkZXJzIiwiZ2V0IiwiZ2V0Q2xpZW50SXBGcm9tUmVxdWVzdCIsImZvcndhcmRlZEZvciIsInJlYWxJcCIsImNmQ29ubmVjdGluZ0lwIiwieENsaWVudElwIiwic3BsaXQiLCJ0cmltIiwiY3JlYXRlRXJyb3JSZXNwb25zZSIsImVycm9yIiwic3RhdHVzIiwiaXNEZXYiLCJwcm9jZXNzIiwiZXJyb3JNZXNzYWdlIiwibWVzc2FnZSIsImxvZ1NlY3VyaXR5RXZlbnQiLCJpcCIsInVzZXJBZ2VudCIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwiUmVzcG9uc2UiLCJqc29uIiwicmVxdWVzdElkIiwiZXZlbnQiLCJkZXRhaWxzIiwibG9nRGF0YSIsImVudmlyb25tZW50IiwiY29uc29sZSIsImxvZyIsIlZhbGlkYXRpb25FcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJmaWVsZCIsIm5hbWUiLCJBdXRoZW50aWNhdGlvbkVycm9yIiwiQXV0aG9yaXphdGlvbkVycm9yIiwiUmF0ZUxpbWl0RXJyb3IiLCJGaWxlVXBsb2FkRXJyb3IiLCJmaWxlIiwiY3JlYXRlU2VjdXJpdHlNaWRkbGV3YXJlIiwidmFsaWRhdGVIZWFkZXJzIiwiY29udGVudFR5cGUiLCJpbmNsdWRlcyIsImlzVmFsaWQiLCJsZW5ndGgiLCJjb250ZW50TGVuZ3RoIiwicGFyc2VJbnQiLCJsb2dSZXF1ZXN0IiwicmVzcG9uc2UiLCJ1cmwiLCJVUkwiLCJtZXRob2QiLCJzdXNwaWNpb3VzUGF0dGVybnMiLCJpc1N1c3BpY2lvdXMiLCJzb21lIiwicGF0dGVybiIsInRlc3QiLCJwYXRobmFtZSIsInNlYXJjaCIsInBhdGgiLCJxdWVyeSIsIndpdGhFcnJvckhhbmRsaW5nIiwiaGFuZGxlciIsImFyZ3MiLCJTdHJpbmciLCJzdGFjayIsInVuZGVmaW5lZCIsInNlY3VyZVJlc3BvbnNlIiwic2V0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/utils/error-handler.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/cookie","vendor-chunks/webidl-conversions","vendor-chunks/zod"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fremove-watermark%2Froute&page=%2Fapi%2Fremove-watermark%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fremove-watermark%2Froute.ts&appDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();