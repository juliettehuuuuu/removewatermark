/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/[...nextauth]/route";
exports.ids = ["app/api/auth/[...nextauth]/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_tutu_Desktop_Be_a_Developer_my_ai_tool_project_src_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/auth/[...nextauth]/route.ts */ \"(rsc)/./src/app/api/auth/[...nextauth]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/[...nextauth]/route\",\n        pathname: \"/api/auth/[...nextauth]\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/[...nextauth]/route\"\n    },\n    resolvedPagePath: \"/Users/tutu/Desktop/Be a Developer/my-ai-tool-project/src/app/api/auth/[...nextauth]/route.ts\",\n    nextConfigOutput,\n    userland: _Users_tutu_Desktop_Be_a_Developer_my_ai_tool_project_src_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGJTVCLi4ubmV4dGF1dGglNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnR1dHUlMkZEZXNrdG9wJTJGQmUlMjBhJTIwRGV2ZWxvcGVyJTJGbXktYWktdG9vbC1wcm9qZWN0JTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRnR1dHUlMkZEZXNrdG9wJTJGQmUlMjBhJTIwRGV2ZWxvcGVyJTJGbXktYWktdG9vbC1wcm9qZWN0JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNxQjtBQUM2QztBQUMxSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjs7QUFFMUYiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL3R1dHUvRGVza3RvcC9CZSBhIERldmVsb3Blci9teS1haS10b29sLXByb2plY3Qvc3JjL2FwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy90dXR1L0Rlc2t0b3AvQmUgYSBEZXZlbG9wZXIvbXktYWktdG9vbC1wcm9qZWN0L3NyYy9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/auth/[...nextauth]/route.ts":
/*!*************************************************!*\
  !*** ./src/app/api/auth/[...nextauth]/route.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ handler),\n/* harmony export */   POST: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n\n\nconst handler = next_auth__WEBPACK_IMPORTED_MODULE_0___default()(_lib_auth__WEBPACK_IMPORTED_MODULE_1__.authOptions);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBZ0M7QUFDUTtBQUV4QyxNQUFNRSxVQUFVRixnREFBUUEsQ0FBQ0Msa0RBQVdBO0FBRU0iLCJzb3VyY2VzIjpbIi9Vc2Vycy90dXR1L0Rlc2t0b3AvQmUgYSBEZXZlbG9wZXIvbXktYWktdG9vbC1wcm9qZWN0L3NyYy9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTmV4dEF1dGggZnJvbSBcIm5leHQtYXV0aFwiXG5pbXBvcnQgeyBhdXRoT3B0aW9ucyB9IGZyb20gXCJAL2xpYi9hdXRoXCJcblxuY29uc3QgaGFuZGxlciA9IE5leHRBdXRoKGF1dGhPcHRpb25zKVxuXG5leHBvcnQgeyBoYW5kbGVyIGFzIEdFVCwgaGFuZGxlciBhcyBQT1NUIH0gIl0sIm5hbWVzIjpbIk5leHRBdXRoIiwiYXV0aE9wdGlvbnMiLCJoYW5kbGVyIiwiR0VUIiwiUE9TVCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/[...nextauth]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions),\n/* harmony export */   providerMap: () => (/* binding */ providerMap)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n\n\nconst providers = [];\n// Google Auth (如果配置了)\n// 已移除\n// Github Auth (如果配置了)\n// 已移除\n// 🔥 简化的邮箱登录 - 只使用Supabase认证\nif (false) {}\nconst providerMap = providers.map((provider)=>{\n    if (typeof provider === \"function\") {\n        const providerData = provider();\n        return {\n            id: providerData.id,\n            name: providerData.name\n        };\n    } else {\n        return {\n            id: provider.id,\n            name: provider.name\n        };\n    }\n});\nconst authOptions = {\n    providers,\n    pages: {\n        signIn: \"/auth/signin\"\n    },\n    // 🍪 Cookie安全配置 - 优化以支持Google One Tap\n    cookies: {\n        sessionToken: {\n            name: `next-auth.session-token`,\n            options: {\n                httpOnly: true,\n                sameSite: 'lax',\n                path: '/',\n                secure: \"development\" === 'production',\n                domain:  false ? 0 : undefined\n            }\n        },\n        callbackUrl: {\n            name: `next-auth.callback-url`,\n            options: {\n                sameSite: 'lax',\n                path: '/',\n                secure: \"development\" === 'production',\n                domain:  false ? 0 : undefined\n            }\n        },\n        csrfToken: {\n            name: `next-auth.csrf-token`,\n            options: {\n                httpOnly: true,\n                sameSite: 'lax',\n                path: '/',\n                secure: \"development\" === 'production',\n                domain:  false ? 0 : undefined\n            }\n        },\n        // 🔧 添加状态Cookie配置以支持Google One Tap\n        state: {\n            name: `next-auth.state`,\n            options: {\n                httpOnly: true,\n                sameSite: 'lax',\n                path: '/',\n                secure: \"development\" === 'production',\n                maxAge: 900,\n                domain:  false ? 0 : undefined\n            }\n        },\n        pkceCodeVerifier: {\n            name: `next-auth.pkce.code_verifier`,\n            options: {\n                httpOnly: true,\n                sameSite: 'lax',\n                path: '/',\n                secure: \"development\" === 'production',\n                maxAge: 900,\n                domain:  false ? 0 : undefined\n            }\n        }\n    },\n    callbacks: {\n        async signIn ({ user, account, profile }) {\n            // 🎯 处理用户登录和首次注册赠送积分\n            console.log('🔍 signIn回调触发:', {\n                user: user,\n                account: account?.provider,\n                profile: profile?.email\n            });\n            try {\n                if (user?.email) {\n                    console.log('🔍 开始处理用户:', user.email);\n                    // 🔧 使用Supabase替代Prisma，确保数据库访问一致性\n                    const { createAdminClient } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/@supabase\"), __webpack_require__.e(\"vendor-chunks/tr46\"), __webpack_require__.e(\"vendor-chunks/whatwg-url\"), __webpack_require__.e(\"vendor-chunks/webidl-conversions\"), __webpack_require__.e(\"_rsc_src_lib_supabase_server_ts\")]).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\"));\n                    const { getUuid } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/uuid\"), __webpack_require__.e(\"_rsc_src_lib_utils_hash_ts\")]).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/utils/hash */ \"(rsc)/./src/lib/utils/hash.ts\"));\n                    console.log('🔍 Supabase模块导入成功');\n                    const supabase = createAdminClient();\n                    // 检查用户是否已存在\n                    console.log('🔍 查询现有用户...');\n                    const { data: existingUser, error: findError } = await supabase.from('users').select('*').eq('email', user.email).limit(1).single();\n                    console.log('🔍 查询结果:', existingUser ? '用户已存在' : '用户不存在');\n                    if (findError && findError.code === 'PGRST116') {\n                        // 用户不存在，创建新用户\n                        console.log('🎁 开始创建新用户...');\n                        const newUserData = {\n                            id: user.id || getUuid(),\n                            email: user.email,\n                            name: user.name || user.email,\n                            image: user.image || '',\n                            credits: 100,\n                            signin_type: account?.type || 'oauth',\n                            signin_provider: account?.provider || 'google',\n                            signin_openid: account?.providerAccountId || '',\n                            signin_ip: 'unknown',\n                            last_signin_at: new Date().toISOString(),\n                            signin_count: 1,\n                            location: 'US',\n                            preferred_currency: 'USD',\n                            preferred_payment_provider: 'creem'\n                        };\n                        const { data: newUser, error: createError } = await supabase.from('users').insert(newUserData).select().single();\n                        if (createError) {\n                            console.error('🚨 新用户创建失败:', createError);\n                        // 即使创建失败，也允许用户登录，后续通过API自动创建\n                        } else {\n                            console.log('🎉 新用户创建成功:', newUser.id);\n                            // 🎁 创建积分赠送记录\n                            try {\n                                await supabase.from('credit_transactions').insert({\n                                    id: getUuid(),\n                                    user_id: newUser.id,\n                                    amount: 100,\n                                    type: 'gift',\n                                    description: '新用户注册赠送积分',\n                                    reference_id: 'welcome_bonus'\n                                });\n                                console.log(`🎁 新用户注册成功，赠送100积分: ${user.email}`);\n                            } catch (creditError) {\n                                console.error('⚠️ 积分记录创建失败:', creditError);\n                            }\n                        }\n                    } else if (!findError && existingUser) {\n                        console.log('🔄 更新现有用户登录信息...');\n                        // 🔄 现有用户：更新登录信息\n                        const updateData = {\n                            last_signin_at: new Date().toISOString(),\n                            signin_count: (existingUser.signin_count || 0) + 1,\n                            // 更新头像和昵称（如果有变化）\n                            ...user.image && {\n                                image: user.image\n                            },\n                            ...user.name && {\n                                name: user.name\n                            }\n                        };\n                        await supabase.from('users').update(updateData).eq('id', existingUser.id);\n                        console.log('✅ 现有用户登录信息更新完成');\n                    } else {\n                        console.error('🚨 数据库查询异常:', findError);\n                    }\n                } else {\n                    console.log('⚠️ 用户邮箱为空，跳过数据库操作');\n                }\n            } catch (error) {\n                console.error('❌ 用户登录处理失败:', error);\n            // 即使数据库操作失败，也允许用户登录\n            }\n            console.log('✅ signIn回调完成，返回true');\n            return true;\n        },\n        async redirect ({ url, baseUrl }) {\n            // 🎯 修改重定向逻辑 - 优先跳转到tool页面（AI图像去水印工具）\n            // 如果URL包含callbackUrl参数，使用该参数\n            if (url.includes('callbackUrl=')) {\n                const urlParams = new URLSearchParams(url.split('?')[1]);\n                const callbackUrl = urlParams.get('callbackUrl');\n                if (callbackUrl) {\n                    // 解码callbackUrl\n                    const decodedCallback = decodeURIComponent(callbackUrl);\n                    if (decodedCallback.startsWith(\"/\")) return `${baseUrl}${decodedCallback}`;\n                    else if (new URL(decodedCallback).origin === baseUrl) return decodedCallback;\n                }\n            }\n            // 如果是相对路径，添加baseUrl\n            if (url.startsWith(\"/\")) return `${baseUrl}${url}`;\n            // 如果是同域名的完整URL，直接返回\n            if (new URL(url).origin === baseUrl) return url;\n            // 🎯 默认跳转到tool页面（AI图像去水印工具）\n            return `${baseUrl}/tool`;\n        },\n        async session ({ session, token }) {\n            // 🎯 会话信息处理\n            return session;\n        },\n        async jwt ({ token, user, account }) {\n            // 🎯 JWT token 处理\n            if (user) {\n                token.user = user;\n            }\n            return token;\n        }\n    }\n};\n// 检测用户地理位置的函数\nasync function detectUserLocation() {\n    try {\n        // 这里可以使用IP地理位置检测服务\n        // 暂时返回默认值，实际项目中可以集成 ipapi.co 等服务\n        return \"US\" // 默认为美国\n        ;\n    } catch (error) {\n        console.error(\"地理位置检测失败:\", error);\n        return \"US\";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxLQUFLLENBQUMsYUFBYUE7UUFDM0IsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy90dXR1L0Rlc2t0b3AvQmUgYSBEZXZlbG9wZXIvbXktYWktdG9vbC1wcm9qZWN0L3NyYy9saWIvYXV0aC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVycy9jcmVkZW50aWFsc1wiXG4vLyBpbXBvcnQgR2l0SHViUHJvdmlkZXIgZnJvbSBcIm5leHQtYXV0aC9wcm92aWRlcnMvZ2l0aHViXCJcbi8vIGltcG9ydCBHb29nbGVQcm92aWRlciBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVycy9nb29nbGVcIlxuaW1wb3J0IHR5cGUgeyBOZXh0QXV0aE9wdGlvbnMgfSBmcm9tIFwibmV4dC1hdXRoXCJcbmltcG9ydCB7IGdldENsaWVudElwIH0gZnJvbSBcIkAvbGliL3V0aWxzL2lwXCJcbmltcG9ydCB7IGdldElzb1RpbWVzdHIgfSBmcm9tIFwiQC9saWIvdXRpbHMvdGltZVwiXG5pbXBvcnQgeyBnZXRVdWlkIH0gZnJvbSBcIkAvbGliL3V0aWxzL2hhc2hcIlxuaW1wb3J0IHsgc2F2ZVVzZXIgfSBmcm9tIFwiQC9saWIvc2VydmljZXMvdXNlclwiXG5pbXBvcnQgeyBVc2VyIH0gZnJvbSBcIkAvbGliL3R5cGVzL3VzZXJcIlxuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJ1xuXG5jb25zdCBwcm92aWRlcnM6IGFueVtdID0gW11cblxuLy8gR29vZ2xlIEF1dGggKOWmguaenOmFjee9ruS6hilcbi8vIOW3suenu+mZpFxuXG4vLyBHaXRodWIgQXV0aCAo5aaC5p6c6YWN572u5LqGKVxuLy8g5bey56e76ZmkXG5cbi8vIPCflKUg566A5YyW55qE6YKu566x55m75b2VIC0g5Y+q5L2/55SoU3VwYWJhc2XorqTor4FcbmlmIChwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BVVRIX0NSRURFTlRJQUxTX0VOQUJMRUQgPT09IFwidHJ1ZVwiKSB7XG4gIHByb3ZpZGVycy5wdXNoKFxuICAgIENyZWRlbnRpYWxzUHJvdmlkZXIoe1xuICAgICAgaWQ6IFwiY3JlZGVudGlhbHNcIixcbiAgICAgIG5hbWU6IFwiY3JlZGVudGlhbHNcIixcbiAgICAgIGNyZWRlbnRpYWxzOiB7XG4gICAgICAgIGVtYWlsOiB7IGxhYmVsOiBcIkVtYWlsXCIsIHR5cGU6IFwiZW1haWxcIiB9LFxuICAgICAgICBwYXNzd29yZDogeyBsYWJlbDogXCJQYXNzd29yZFwiLCB0eXBlOiBcInBhc3N3b3JkXCIgfVxuICAgICAgfSxcbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzPy5lbWFpbCB8fCAhY3JlZGVudGlhbHM/LnBhc3N3b3JkKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIPCfjq8g5byA5Y+R546v5aKD5rWL6K+V6LSm5oi377yI5peg6ZyA5pWw5o2u5bqT77yJXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyAmJiBcbiAgICAgICAgICAgIGNyZWRlbnRpYWxzLmVtYWlsID09PSBcInRlc3RAZXhhbXBsZS5jb21cIiAmJiBcbiAgICAgICAgICAgIGNyZWRlbnRpYWxzLnBhc3N3b3JkID09PSBcInBhc3N3b3JkXCIpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IFwidGVzdC11c2VyLWlkXCIsXG4gICAgICAgICAgICBlbWFpbDogXCJ0ZXN0QGV4YW1wbGUuY29tXCIsXG4gICAgICAgICAgICBuYW1lOiBcIlRlc3QgVXNlclwiLFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIPCfmoAg55Sf5Lqn546v5aKD77ya5L2/55SoU3VwYWJhc2XorqTor4HvvIjoh6rluKbpgq7nrrHpqozor4HvvIlcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+UjSDlvIDlp4tTdXBhYmFzZeeZu+W9lemqjOivgTonLCBjcmVkZW50aWFscy5lbWFpbClcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChcbiAgICAgICAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgICAgICAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSFcbiAgICAgICAgICApXG5cbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+UjSBTdXBhYmFzZeWuouaIt+err+WIm+W7uuaIkOWKnycpXG5cbiAgICAgICAgICAvLyDwn5SQIFN1cGFiYXNl55m75b2V6aqM6K+B77yI6Ieq5Yqo5qOA5p+l6YKu566x6aqM6K+B54q25oCB77yJXG4gICAgICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQoe1xuICAgICAgICAgICAgZW1haWw6IGNyZWRlbnRpYWxzLmVtYWlsLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IGNyZWRlbnRpYWxzLnBhc3N3b3JkLFxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+UjSBTdXBhYmFzZeeZu+W9lee7k+aenDonLCB7IFxuICAgICAgICAgICAgc3VjY2VzczogIWVycm9yLCBcbiAgICAgICAgICAgIGVycm9yOiBlcnJvcj8ubWVzc2FnZSxcbiAgICAgICAgICAgIHVzZXJFeGlzdHM6ICEhZGF0YT8udXNlcixcbiAgICAgICAgICAgIHVzZXJJZDogZGF0YT8udXNlcj8uaWQgXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+KdjCDnmbvlvZXlpLHotKU6JywgZXJyb3IubWVzc2FnZSlcbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFkYXRhLnVzZXIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinYwg55So5oi35LiN5a2Y5ZyoJylcbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc29sZS5sb2coJ+KchSDnmbvlvZXmiJDlip/vvIzov5Tlm57nlKjmiLfkv6Hmga8nKVxuICAgICAgICAgIC8vIPCfjokg55m75b2V5oiQ5YqfXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBkYXRhLnVzZXIuaWQsXG4gICAgICAgICAgICBlbWFpbDogZGF0YS51c2VyLmVtYWlsISxcbiAgICAgICAgICAgIG5hbWU6IGRhdGEudXNlci51c2VyX21ldGFkYXRhPy5uYW1lIHx8IGRhdGEudXNlci5lbWFpbCEsXG4gICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFN1cGFiYXNl6K6k6K+B5byC5bi4OicsIGVycm9yKVxuICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSlcbiAgKVxufVxuXG5leHBvcnQgY29uc3QgcHJvdmlkZXJNYXAgPSBwcm92aWRlcnNcbiAgLm1hcCgocHJvdmlkZXI6IGFueSkgPT4ge1xuICAgIGlmICh0eXBlb2YgcHJvdmlkZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY29uc3QgcHJvdmlkZXJEYXRhID0gcHJvdmlkZXIoKVxuICAgICAgcmV0dXJuIHsgaWQ6IHByb3ZpZGVyRGF0YS5pZCwgbmFtZTogcHJvdmlkZXJEYXRhLm5hbWUgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4geyBpZDogcHJvdmlkZXIuaWQsIG5hbWU6IHByb3ZpZGVyLm5hbWUgfVxuICAgIH1cbiAgfSlcblxuZXhwb3J0IGNvbnN0IGF1dGhPcHRpb25zOiBOZXh0QXV0aE9wdGlvbnMgPSB7XG4gIHByb3ZpZGVycyxcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46IFwiL2F1dGgvc2lnbmluXCIsXG4gIH0sXG4gIC8vIPCfjaogQ29va2ll5a6J5YWo6YWN572uIC0g5LyY5YyW5Lul5pSv5oyBR29vZ2xlIE9uZSBUYXBcbiAgY29va2llczoge1xuICAgIHNlc3Npb25Ub2tlbjoge1xuICAgICAgbmFtZTogYG5leHQtYXV0aC5zZXNzaW9uLXRva2VuYCxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgIHNhbWVTaXRlOiAnbGF4JywgICAgICAgIC8vIPCflKcg6K6+572u5Li6bGF46ICM6Z2ec3RyaWN077yM5pSv5oyB56ys5LiJ5pa555m75b2VXG4gICAgICAgIHBhdGg6ICcvJyxcbiAgICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgICAgICBkb21haW46IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnZmx1eGtvbnRleHQuc3BhY2UnIDogdW5kZWZpbmVkLCAvLyDwn4yQIOaYjuehruaMh+WumuWfn+WQjVxuICAgICAgfSxcbiAgICB9LFxuICAgIGNhbGxiYWNrVXJsOiB7XG4gICAgICBuYW1lOiBgbmV4dC1hdXRoLmNhbGxiYWNrLXVybGAsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIHNhbWVTaXRlOiAnbGF4JywgICAgICAgIC8vIPCflKcg5pSv5oyB6Leo56uZ54K55Zue6LCDXG4gICAgICAgIHBhdGg6ICcvJyxcbiAgICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgICAgICBkb21haW46IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnZmx1eGtvbnRleHQuc3BhY2UnIDogdW5kZWZpbmVkLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGNzcmZUb2tlbjoge1xuICAgICAgbmFtZTogYG5leHQtYXV0aC5jc3JmLXRva2VuYCxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgIHNhbWVTaXRlOiAnbGF4JywgICAgICAgIC8vIPCflKcg5pSv5oyBQ1NSRuS/neaKpOS9huWFgeiuuOesrOS4ieaWueeZu+W9lVxuICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICAgICAgZG9tYWluOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJ2ZsdXhrb250ZXh0LnNwYWNlJyA6IHVuZGVmaW5lZCxcbiAgICAgIH0sXG4gICAgfSxcbiAgICAvLyDwn5SnIOa3u+WKoOeKtuaAgUNvb2tpZemFjee9ruS7peaUr+aMgUdvb2dsZSBPbmUgVGFwXG4gICAgc3RhdGU6IHtcbiAgICAgIG5hbWU6IGBuZXh0LWF1dGguc3RhdGVgLFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICAgICAgbWF4QWdlOiA5MDAsIC8vIDE15YiG6ZKfXG4gICAgICAgIGRvbWFpbjogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdmbHV4a29udGV4dC5zcGFjZScgOiB1bmRlZmluZWQsXG4gICAgICB9LFxuICAgIH0sXG4gICAgcGtjZUNvZGVWZXJpZmllcjoge1xuICAgICAgbmFtZTogYG5leHQtYXV0aC5wa2NlLmNvZGVfdmVyaWZpZXJgLFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICAgICAgbWF4QWdlOiA5MDAsIC8vIDE15YiG6ZKfXG4gICAgICAgIGRvbWFpbjogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdmbHV4a29udGV4dC5zcGFjZScgOiB1bmRlZmluZWQsXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIGNhbGxiYWNrczoge1xuICAgIGFzeW5jIHNpZ25Jbih7IHVzZXIsIGFjY291bnQsIHByb2ZpbGUgfSkge1xuICAgICAgLy8g8J+OryDlpITnkIbnlKjmiLfnmbvlvZXlkozpppbmrKHms6jlhozotaDpgIHnp6/liIZcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIHNpZ25JbuWbnuiwg+inpuWPkTonLCB7IFxuICAgICAgICB1c2VyOiB1c2VyLCBcbiAgICAgICAgYWNjb3VudDogYWNjb3VudD8ucHJvdmlkZXIsIFxuICAgICAgICBwcm9maWxlOiBwcm9maWxlPy5lbWFpbCBcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICh1c2VyPy5lbWFpbCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIOW8gOWni+WkhOeQhueUqOaItzonLCB1c2VyLmVtYWlsKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIPCflKcg5L2/55SoU3VwYWJhc2Xmm7/ku6NQcmlzbWHvvIznoa7kv53mlbDmja7lupPorr/pl67kuIDoh7TmgKdcbiAgICAgICAgICBjb25zdCB7IGNyZWF0ZUFkbWluQ2xpZW50IH0gPSBhd2FpdCBpbXBvcnQoJ0AvbGliL3N1cGFiYXNlL3NlcnZlcicpXG4gICAgICAgICAgY29uc3QgeyBnZXRVdWlkIH0gPSBhd2FpdCBpbXBvcnQoJ0AvbGliL3V0aWxzL2hhc2gnKVxuICAgICAgICAgIFxuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFN1cGFiYXNl5qih5Z2X5a+85YWl5oiQ5YqfJylcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUFkbWluQ2xpZW50KClcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDmo4Dmn6XnlKjmiLfmmK/lkKblt7LlrZjlnKhcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+UjSDmn6Xor6LnjrDmnInnlKjmiLcuLi4nKVxuICAgICAgICAgIGNvbnN0IHsgZGF0YTogZXhpc3RpbmdVc2VyLCBlcnJvcjogZmluZEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAgICAgLmVxKCdlbWFpbCcsIHVzZXIuZW1haWwpXG4gICAgICAgICAgICAubGltaXQoMSlcbiAgICAgICAgICAgIC5zaW5nbGUoKVxuICAgICAgICAgIFxuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIOafpeivoue7k+aenDonLCBleGlzdGluZ1VzZXIgPyAn55So5oi35bey5a2Y5ZyoJyA6ICfnlKjmiLfkuI3lrZjlnKgnKVxuXG4gICAgICAgICAgaWYgKGZpbmRFcnJvciAmJiBmaW5kRXJyb3IuY29kZSA9PT0gJ1BHUlNUMTE2Jykge1xuICAgICAgICAgICAgLy8g55So5oi35LiN5a2Y5Zyo77yM5Yib5bu65paw55So5oi3XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn8J+OgSDlvIDlp4vliJvlu7rmlrDnlKjmiLcuLi4nKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBuZXdVc2VyRGF0YSA9IHtcbiAgICAgICAgICAgICAgaWQ6IHVzZXIuaWQgfHwgZ2V0VXVpZCgpLFxuICAgICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lIHx8IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgIGltYWdlOiB1c2VyLmltYWdlIHx8ICcnLFxuICAgICAgICAgICAgICBjcmVkaXRzOiAxMDAsIC8vIPCfjoEg5paw55So5oi36LWg6YCBMTAw56ev5YiGXG4gICAgICAgICAgICAgIHNpZ25pbl90eXBlOiBhY2NvdW50Py50eXBlIHx8ICdvYXV0aCcsXG4gICAgICAgICAgICAgIHNpZ25pbl9wcm92aWRlcjogYWNjb3VudD8ucHJvdmlkZXIgfHwgJ2dvb2dsZScsXG4gICAgICAgICAgICAgIHNpZ25pbl9vcGVuaWQ6IGFjY291bnQ/LnByb3ZpZGVyQWNjb3VudElkIHx8ICcnLFxuICAgICAgICAgICAgICBzaWduaW5faXA6ICd1bmtub3duJyxcbiAgICAgICAgICAgICAgbGFzdF9zaWduaW5fYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgc2lnbmluX2NvdW50OiAxLFxuICAgICAgICAgICAgICBsb2NhdGlvbjogJ1VTJyxcbiAgICAgICAgICAgICAgcHJlZmVycmVkX2N1cnJlbmN5OiAnVVNEJyxcbiAgICAgICAgICAgICAgcHJlZmVycmVkX3BheW1lbnRfcHJvdmlkZXI6ICdjcmVlbSdcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgeyBkYXRhOiBuZXdVc2VyLCBlcnJvcjogY3JlYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAgIC5mcm9tKCd1c2VycycpXG4gICAgICAgICAgICAgIC5pbnNlcnQobmV3VXNlckRhdGEpXG4gICAgICAgICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAgICAgICAuc2luZ2xlKClcblxuICAgICAgICAgICAgaWYgKGNyZWF0ZUVycm9yKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ/Cfmqgg5paw55So5oi35Yib5bu65aSx6LSlOicsIGNyZWF0ZUVycm9yKVxuICAgICAgICAgICAgICAvLyDljbPkvb/liJvlu7rlpLHotKXvvIzkuZ/lhYHorrjnlKjmiLfnmbvlvZXvvIzlkI7nu63pgJrov4dBUEnoh6rliqjliJvlu7pcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn46JIOaWsOeUqOaIt+WIm+W7uuaIkOWKnzonLCBuZXdVc2VyLmlkKVxuXG4gICAgICAgICAgICAgIC8vIPCfjoEg5Yib5bu656ev5YiG6LWg6YCB6K6w5b2VXG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgICAgICAgIC5mcm9tKCdjcmVkaXRfdHJhbnNhY3Rpb25zJylcbiAgICAgICAgICAgICAgICAgIC5pbnNlcnQoe1xuICAgICAgICAgICAgICAgICAgICBpZDogZ2V0VXVpZCgpLFxuICAgICAgICAgICAgICAgICAgICB1c2VyX2lkOiBuZXdVc2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2dpZnQnLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ+aWsOeUqOaIt+azqOWGjOi1oOmAgeenr+WIhicsXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZV9pZDogJ3dlbGNvbWVfYm9udXMnXG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn46BIOaWsOeUqOaIt+azqOWGjOaIkOWKn++8jOi1oOmAgTEwMOenr+WIhjogJHt1c2VyLmVtYWlsfWApXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGNyZWRpdEVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4pqg77iPIOenr+WIhuiusOW9leWIm+W7uuWksei0pTonLCBjcmVkaXRFcnJvcilcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoIWZpbmRFcnJvciAmJiBleGlzdGluZ1VzZXIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIOabtOaWsOeOsOacieeUqOaIt+eZu+W9leS/oeaBry4uLicpXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIPCflIQg546w5pyJ55So5oi377ya5pu05paw55m75b2V5L+h5oGvXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICAgICAgICBsYXN0X3NpZ25pbl9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICBzaWduaW5fY291bnQ6IChleGlzdGluZ1VzZXIuc2lnbmluX2NvdW50IHx8IDApICsgMSxcbiAgICAgICAgICAgICAgLy8g5pu05paw5aS05YOP5ZKM5pi156ew77yI5aaC5p6c5pyJ5Y+Y5YyW77yJXG4gICAgICAgICAgICAgIC4uLih1c2VyLmltYWdlICYmIHsgaW1hZ2U6IHVzZXIuaW1hZ2UgfSksXG4gICAgICAgICAgICAgIC4uLih1c2VyLm5hbWUgJiYgeyBuYW1lOiB1c2VyLm5hbWUgfSksXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAgIC5mcm9tKCd1c2VycycpXG4gICAgICAgICAgICAgIC51cGRhdGUodXBkYXRlRGF0YSlcbiAgICAgICAgICAgICAgLmVxKCdpZCcsIGV4aXN0aW5nVXNlci5pZClcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+KchSDnjrDmnInnlKjmiLfnmbvlvZXkv6Hmga/mm7TmlrDlrozmiJAnKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfwn5qoIOaVsOaNruW6k+afpeivouW8guW4uDonLCBmaW5kRXJyb3IpXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfimqDvuI8g55So5oi36YKu566x5Li656m677yM6Lez6L+H5pWw5o2u5bqT5pON5L2cJylcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIOeUqOaIt+eZu+W9leWkhOeQhuWksei0pTonLCBlcnJvcilcbiAgICAgICAgLy8g5Y2z5L2/5pWw5o2u5bqT5pON5L2c5aSx6LSl77yM5Lmf5YWB6K6455So5oi355m75b2VXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgc2lnbklu5Zue6LCD5a6M5oiQ77yM6L+U5ZuedHJ1ZScpXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH0sXG4gICAgYXN5bmMgcmVkaXJlY3QoeyB1cmwsIGJhc2VVcmwgfSkge1xuICAgICAgLy8g8J+OryDkv67mlLnph43lrprlkJHpgLvovpEgLSDkvJjlhYjot7PovazliLB0b29s6aG16Z2i77yIQUnlm77lg4/ljrvmsLTljbDlt6XlhbfvvIlcbiAgICAgIFxuICAgICAgLy8g5aaC5p6cVVJM5YyF5ZCrY2FsbGJhY2tVcmzlj4LmlbDvvIzkvb/nlKjor6Xlj4LmlbBcbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJ2NhbGxiYWNrVXJsPScpKSB7XG4gICAgICAgIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXModXJsLnNwbGl0KCc/JylbMV0pXG4gICAgICAgIGNvbnN0IGNhbGxiYWNrVXJsID0gdXJsUGFyYW1zLmdldCgnY2FsbGJhY2tVcmwnKVxuICAgICAgICBpZiAoY2FsbGJhY2tVcmwpIHtcbiAgICAgICAgICAvLyDop6PnoIFjYWxsYmFja1VybFxuICAgICAgICAgIGNvbnN0IGRlY29kZWRDYWxsYmFjayA9IGRlY29kZVVSSUNvbXBvbmVudChjYWxsYmFja1VybClcbiAgICAgICAgICBpZiAoZGVjb2RlZENhbGxiYWNrLnN0YXJ0c1dpdGgoXCIvXCIpKSByZXR1cm4gYCR7YmFzZVVybH0ke2RlY29kZWRDYWxsYmFja31gXG4gICAgICAgICAgZWxzZSBpZiAobmV3IFVSTChkZWNvZGVkQ2FsbGJhY2spLm9yaWdpbiA9PT0gYmFzZVVybCkgcmV0dXJuIGRlY29kZWRDYWxsYmFja1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOWmguaenOaYr+ebuOWvuei3r+W+hO+8jOa3u+WKoGJhc2VVcmxcbiAgICAgIGlmICh1cmwuc3RhcnRzV2l0aChcIi9cIikpIHJldHVybiBgJHtiYXNlVXJsfSR7dXJsfWBcbiAgICAgIFxuICAgICAgLy8g5aaC5p6c5piv5ZCM5Z+f5ZCN55qE5a6M5pW0VVJM77yM55u05o6l6L+U5ZueXG4gICAgICBpZiAobmV3IFVSTCh1cmwpLm9yaWdpbiA9PT0gYmFzZVVybCkgcmV0dXJuIHVybFxuICAgICAgXG4gICAgICAvLyDwn46vIOm7mOiupOi3s+i9rOWIsHRvb2zpobXpnaLvvIhBSeWbvuWDj+WOu+awtOWNsOW3peWFt++8iVxuICAgICAgcmV0dXJuIGAke2Jhc2VVcmx9L3Rvb2xgXG4gICAgfSxcbiAgICBhc3luYyBzZXNzaW9uKHsgc2Vzc2lvbiwgdG9rZW4gfSkge1xuICAgICAgLy8g8J+OryDkvJror53kv6Hmga/lpITnkIZcbiAgICAgIHJldHVybiBzZXNzaW9uXG4gICAgfSxcbiAgICBhc3luYyBqd3QoeyB0b2tlbiwgdXNlciwgYWNjb3VudCB9OiB7IHRva2VuOiBhbnk7IHVzZXI/OiBhbnk7IGFjY291bnQ/OiBhbnkgfSkge1xuICAgICAgLy8g8J+OryBKV1QgdG9rZW4g5aSE55CGXG4gICAgICBpZiAodXNlcikge1xuICAgICAgICB0b2tlbi51c2VyID0gdXNlciBhcyBhbnlcbiAgICAgIH1cbiAgICAgIHJldHVybiB0b2tlblxuICAgIH0sXG4gIH0sXG59XG5cbi8vIOajgOa1i+eUqOaIt+WcsOeQhuS9jee9rueahOWHveaVsFxuYXN5bmMgZnVuY3Rpb24gZGV0ZWN0VXNlckxvY2F0aW9uKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHRyeSB7XG4gICAgLy8g6L+Z6YeM5Y+v5Lul5L2/55SoSVDlnLDnkIbkvY3nva7mo4DmtYvmnI3liqFcbiAgICAvLyDmmoLml7bov5Tlm57pu5jorqTlgLzvvIzlrp7pmYXpobnnm67kuK3lj6/ku6Xpm4bmiJAgaXBhcGkuY28g562J5pyN5YqhXG4gICAgcmV0dXJuIFwiVVNcIiAvLyDpu5jorqTkuLrnvo7lm71cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwi5Zyw55CG5L2N572u5qOA5rWL5aSx6LSlOlwiLCBlcnJvcilcbiAgICByZXR1cm4gXCJVU1wiXG4gIH1cbn0gIl0sIm5hbWVzIjpbIkNyZWRlbnRpYWxzUHJvdmlkZXIiLCJjcmVhdGVDbGllbnQiLCJwcm92aWRlcnMiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQVVUSF9DUkVERU5USUFMU19FTkFCTEVEIiwicHVzaCIsImlkIiwibmFtZSIsImNyZWRlbnRpYWxzIiwiZW1haWwiLCJsYWJlbCIsInR5cGUiLCJwYXNzd29yZCIsImF1dGhvcml6ZSIsImNvbnNvbGUiLCJsb2ciLCJzdXBhYmFzZSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiZGF0YSIsImVycm9yIiwiYXV0aCIsInNpZ25JbldpdGhQYXNzd29yZCIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwidXNlckV4aXN0cyIsInVzZXIiLCJ1c2VySWQiLCJ1c2VyX21ldGFkYXRhIiwicHJvdmlkZXJNYXAiLCJtYXAiLCJwcm92aWRlciIsInByb3ZpZGVyRGF0YSIsImF1dGhPcHRpb25zIiwicGFnZXMiLCJzaWduSW4iLCJjb29raWVzIiwic2Vzc2lvblRva2VuIiwib3B0aW9ucyIsImh0dHBPbmx5Iiwic2FtZVNpdGUiLCJwYXRoIiwic2VjdXJlIiwiZG9tYWluIiwidW5kZWZpbmVkIiwiY2FsbGJhY2tVcmwiLCJjc3JmVG9rZW4iLCJzdGF0ZSIsIm1heEFnZSIsInBrY2VDb2RlVmVyaWZpZXIiLCJjYWxsYmFja3MiLCJhY2NvdW50IiwicHJvZmlsZSIsImNyZWF0ZUFkbWluQ2xpZW50IiwiZ2V0VXVpZCIsImV4aXN0aW5nVXNlciIsImZpbmRFcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsImxpbWl0Iiwic2luZ2xlIiwiY29kZSIsIm5ld1VzZXJEYXRhIiwiaW1hZ2UiLCJjcmVkaXRzIiwic2lnbmluX3R5cGUiLCJzaWduaW5fcHJvdmlkZXIiLCJzaWduaW5fb3BlbmlkIiwicHJvdmlkZXJBY2NvdW50SWQiLCJzaWduaW5faXAiLCJsYXN0X3NpZ25pbl9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNpZ25pbl9jb3VudCIsImxvY2F0aW9uIiwicHJlZmVycmVkX2N1cnJlbmN5IiwicHJlZmVycmVkX3BheW1lbnRfcHJvdmlkZXIiLCJuZXdVc2VyIiwiY3JlYXRlRXJyb3IiLCJpbnNlcnQiLCJ1c2VyX2lkIiwiYW1vdW50IiwiZGVzY3JpcHRpb24iLCJyZWZlcmVuY2VfaWQiLCJjcmVkaXRFcnJvciIsInVwZGF0ZURhdGEiLCJ1cGRhdGUiLCJyZWRpcmVjdCIsInVybCIsImJhc2VVcmwiLCJpbmNsdWRlcyIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsInNwbGl0IiwiZ2V0IiwiZGVjb2RlZENhbGxiYWNrIiwiZGVjb2RlVVJJQ29tcG9uZW50Iiwic3RhcnRzV2l0aCIsIlVSTCIsIm9yaWdpbiIsInNlc3Npb24iLCJ0b2tlbiIsImp3dCIsImRldGVjdFVzZXJMb2NhdGlvbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/oauth","vendor-chunks/@panva","vendor-chunks/yallist","vendor-chunks/preact-render-to-string","vendor-chunks/oidc-token-hash","vendor-chunks/preact","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftutu%2FDesktop%2FBe%20a%20Developer%2Fmy-ai-tool-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();